/*
+--------------+--------+-----------+------------+-------------+------------+--------------+---------------+-------------+--------+-------------------------+-------------------------+
| DW_GC_HEADER | DW_DAY | DW_RESTID | DW_PRODUCT | DW_LINEITEM | ACTQTYSOLD | ACTPRODPRICE | ACTGROSSSALES | ACTNETSALES | ACTTAX | LINEITEMDESC            | PRODUCTDESC             |
+--------------+--------+-----------+------------+-------------+------------+--------------+---------------+-------------+--------+-------------------------+-------------------------+
|   2193837648 |   6210 |     31704 |         -1 |          14 |       0.00 |         0.00 |          0.00 |        0.00 |   0.86 | TAX-LINE                | N/A                     |
|   2193837648 |   6210 |     31704 |        884 |           2 |       1.00 |         2.99 |          2.99 |        2.99 |   0.00 | NON-COMBO-ITEM          | GRILL STUFT BURRITO STK |
|   2193837648 |   6210 |     31704 |       1691 |           4 |       1.00 |         0.00 |          0.00 |        0.00 |   0.00 | COMBO-DETAIL-REPLS-PLUS | COMBO 6                 |
|   2193837648 |   6210 |     31704 |       1691 |           3 |       1.00 |         0.00 |          0.00 |        0.00 |   0.00 | COMBO-DETAIL            | COMBO 6                 |
|   2193837648 |   6210 |     31704 |       1691 |           4 |       1.00 |         0.00 |          0.00 |        0.00 |   0.00 | COMBO-DETAIL-REPLS-PLUS | COMBO 6                 |
|   2193837648 |   6210 |     31704 |       1691 |           3 |       1.00 |         0.00 |          0.00 |        0.00 |   0.00 | COMBO-DETAIL            | COMBO 6                 |
|   2193837648 |   6210 |     31704 |       1691 |           1 |       1.00 |         5.69 |          5.69 |        5.69 |   0.00 | COMBO-ITEM              | COMBO 6                 |
|   2193837648 |   6210 |     31704 |       4035 |           2 |       1.00 |         1.69 |          1.69 |        1.69 |   0.00 | NON-COMBO-ITEM          | GRILLED STEAK TACO      |
|   2193837648 |   6210 |     31704 |         -1 |          14 |       0.00 |         0.00 |          0.00 |        0.00 |   0.86 | TAX-LINE                | N/A                     |
|   2193837648 |   6210 |     31704 |        884 |           2 |       1.00 |         2.99 |          2.99 |        2.99 |   0.00 | NON-COMBO-ITEM          | GRILL STUFT BURRITO STK |
|   2193837648 |   6210 |     31704 |       1691 |           4 |       1.00 |         0.00 |          0.00 |        0.00 |   0.00 | COMBO-DETAIL-REPLS-PLUS | COMBO 6                 |
|   2193837648 |   6210 |     31704 |       1691 |           3 |       1.00 |         0.00 |          0.00 |        0.00 |   0.00 | COMBO-DETAIL            | COMBO 6                 |
|   2193837648 |   6210 |     31704 |       1691 |           4 |       1.00 |         0.00 |          0.00 |        0.00 |   0.00 | COMBO-DETAIL-REPLS-PLUS | COMBO 6                 |
|   2193837648 |   6210 |     31704 |       1691 |           3 |       1.00 |         0.00 |          0.00 |        0.00 |   0.00 | COMBO-DETAIL            | COMBO 6                 |
|   2193837648 |   6210 |     31704 |       1691 |           1 |       1.00 |         5.69 |          5.69 |        5.69 |   0.00 | COMBO-ITEM              | COMBO 6                 |
|   2193837648 |   6210 |     31704 |       4035 |           2 |       1.00 |         1.69 |          1.69 |        1.69 |   0.00 | NON-COMBO-ITEM          | GRILLED STEAK TACO      |
+--------------+--------+-----------+------------+-------------+------------+--------------+---------------+-------------+--------+-------------------------+-------------------------+
*/

-- select sample transactions
select t.DW_GC_HEADER, t.DW_DAY, t.DW_RESTID, t.DW_PRODUCT, p.PRODUCTDESC, t.DW_LINEITEM, l.LINEITEMDESC, t.ACTQTYSOLD, t.ACTPRODPRICE, t.ACTGROSSSALES, t.ACTTAX, a.OPENEDDT, a.CLOSEDDT
from TLD_FACT t
    left join LINEITEM_DIM l using (DW_LINEITEM)
    left join PRODUCT_DIM p using (DW_PRODUCT)
    left join ALIGN_DIM a using (DW_RESTID)
where DW_GC_HEADER=2193837648
    or DW_GC_HEADER=2193837602
    or DW_GC_HEADER=2193837510
    or DW_GC_HEADER=2193838982
order by DW_GC_HEADER; --16 min 4.40 sec
/*
+--------------+--------+-----------+------------+-------------------------+-------------+-------------------------+------------+--------------+---------------+--------+------------+------------+
| DW_GC_HEADER | DW_DAY | DW_RESTID | DW_PRODUCT | PRODUCTDESC             | DW_LINEITEM | LINEITEMDESC            | ACTQTYSOLD | ACTPRODPRICE | ACTGROSSSALES | ACTTAX | OPENEDDT   | CLOSEDDT   |
+--------------+--------+-----------+------------+-------------------------+-------------+-------------------------+------------+--------------+---------------+--------+------------+------------+
|   2193837510 |   6210 |     31704 |         -1 | N/A                     |          14 | TAX-LINE                |       0.00 |         0.00 |          0.00 |   0.43 | 2001-06-13 | 2007-12-23 |
|   2193837510 |   6210 |     31704 |       4001 | SOFT TACO BEEF          |           2 | NON-COMBO-ITEM          |       2.00 |         0.79 |          1.58 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837510 |   6210 |     31704 |      19494 | TB CRUNCHWRAP SUP CMB   |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837510 |   6210 |     31704 |      19494 | TB CRUNCHWRAP SUP CMB   |           8 | COMBO-MOD-INGRD-MINUS   |       0.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837510 |   6210 |     31704 |      19494 | TB CRUNCHWRAP SUP CMB   |           8 | COMBO-MOD-INGRD-MINUS   |       0.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837510 |   6210 |     31704 |      19494 | TB CRUNCHWRAP SUP CMB   |           1 | COMBO-ITEM              |       1.00 |         3.69 |          3.69 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837510 |   6210 |     31704 |      19494 | TB CRUNCHWRAP SUP CMB   |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837510 |   6210 |     31704 |      19494 | TB CRUNCHWRAP SUP CMB   |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837510 |   6210 |     31704 |      19494 | TB CRUNCHWRAP SUP CMB   |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837510 |   6210 |     31704 |         -1 | N/A                     |          14 | TAX-LINE                |       0.00 |         0.00 |          0.00 |   0.43 | 2001-06-13 | 2007-12-23 |
|   2193837510 |   6210 |     31704 |      19494 | TB CRUNCHWRAP SUP CMB   |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837510 |   6210 |     31704 |      19494 | TB CRUNCHWRAP SUP CMB   |           1 | COMBO-ITEM              |       1.00 |         3.69 |          3.69 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837510 |   6210 |     31704 |      19494 | TB CRUNCHWRAP SUP CMB   |           8 | COMBO-MOD-INGRD-MINUS   |       0.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837510 |   6210 |     31704 |      19494 | TB CRUNCHWRAP SUP CMB   |           8 | COMBO-MOD-INGRD-MINUS   |       0.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837510 |   6210 |     31704 |      19494 | TB CRUNCHWRAP SUP CMB   |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837510 |   6210 |     31704 |       4001 | SOFT TACO BEEF          |          11 | NON-COMBO-M-INGRD-MINUS |       0.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837510 |   6210 |     31704 |       4001 | SOFT TACO BEEF          |           2 | NON-COMBO-ITEM          |       2.00 |         0.79 |          1.58 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837510 |   6210 |     31704 |       4001 | SOFT TACO BEEF          |          11 | NON-COMBO-M-INGRD-MINUS |       0.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837602 |   6210 |     31704 |         -1 | N/A                     |          14 | TAX-LINE                |       0.00 |         0.00 |          0.00 |   0.79 | 2001-06-13 | 2007-12-23 |
|   2193837602 |   6210 |     31704 |       1689 | COMBO 4                 |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837602 |   6210 |     31704 |       1689 | COMBO 4                 |           3 | COMBO-DETAIL            |       2.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837602 |   6210 |     31704 |       1689 | COMBO 4                 |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837602 |   6210 |     31704 |       1689 | COMBO 4                 |           1 | COMBO-ITEM              |       1.00 |         4.99 |          4.99 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837602 |   6210 |     31704 |       1690 | COMBO 5                 |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837602 |   6210 |     31704 |       1690 | COMBO 5                 |           1 | COMBO-ITEM              |       1.00 |         4.59 |          4.59 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837602 |   6210 |     31704 |       1690 | COMBO 5                 |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837602 |   6210 |     31704 |       1690 | COMBO 5                 |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837602 |   6210 |     31704 |       1690 | COMBO 5                 |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837602 |   6210 |     31704 |       1690 | COMBO 5                 |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837602 |   6210 |     31704 |       1690 | COMBO 5                 |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837602 |   6210 |     31704 |       1690 | COMBO 5                 |           1 | COMBO-ITEM              |       1.00 |         4.59 |          4.59 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837602 |   6210 |     31704 |       1689 | COMBO 4                 |           1 | COMBO-ITEM              |       1.00 |         4.99 |          4.99 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837602 |   6210 |     31704 |       1689 | COMBO 4                 |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837602 |   6210 |     31704 |       1689 | COMBO 4                 |           3 | COMBO-DETAIL            |       2.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837602 |   6210 |     31704 |       1689 | COMBO 4                 |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837602 |   6210 |     31704 |         -1 | N/A                     |          14 | TAX-LINE                |       0.00 |         0.00 |          0.00 |   0.79 | 2001-06-13 | 2007-12-23 |
|   2193837648 |   6210 |     31704 |       4035 | GRILLED STEAK TACO      |           2 | NON-COMBO-ITEM          |       1.00 |         1.69 |          1.69 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837648 |   6210 |     31704 |       1691 | COMBO 6                 |           4 | COMBO-DETAIL-REPLS-PLUS |       1.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837648 |   6210 |     31704 |       1691 | COMBO 6                 |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837648 |   6210 |     31704 |         -1 | N/A                     |          14 | TAX-LINE                |       0.00 |         0.00 |          0.00 |   0.86 | 2001-06-13 | 2007-12-23 |
|   2193837648 |   6210 |     31704 |       1691 | COMBO 6                 |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837648 |   6210 |     31704 |        884 | GRILL STUFT BURRITO STK |           2 | NON-COMBO-ITEM          |       1.00 |         2.99 |          2.99 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837648 |   6210 |     31704 |       1691 | COMBO 6                 |           4 | COMBO-DETAIL-REPLS-PLUS |       1.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837648 |   6210 |     31704 |       1691 | COMBO 6                 |           4 | COMBO-DETAIL-REPLS-PLUS |       1.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837648 |   6210 |     31704 |         -1 | N/A                     |          14 | TAX-LINE                |       0.00 |         0.00 |          0.00 |   0.86 | 2001-06-13 | 2007-12-23 |
|   2193837648 |   6210 |     31704 |       1691 | COMBO 6                 |           1 | COMBO-ITEM              |       1.00 |         5.69 |          5.69 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837648 |   6210 |     31704 |        884 | GRILL STUFT BURRITO STK |           2 | NON-COMBO-ITEM          |       1.00 |         2.99 |          2.99 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837648 |   6210 |     31704 |       4035 | GRILLED STEAK TACO      |           2 | NON-COMBO-ITEM          |       1.00 |         1.69 |          1.69 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837648 |   6210 |     31704 |       1691 | COMBO 6                 |           1 | COMBO-ITEM              |       1.00 |         5.69 |          5.69 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837648 |   6210 |     31704 |       1691 | COMBO 6                 |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837648 |   6210 |     31704 |       1691 | COMBO 6                 |           4 | COMBO-DETAIL-REPLS-PLUS |       1.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837648 |   6210 |     31704 |       1691 | COMBO 6                 |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193838982 |   6210 |     31751 |       1680 | COMBO 1                 |           1 | COMBO-ITEM              |       1.00 |         4.19 |          4.19 |   0.00 | 1995-04-21 | 2012-10-02 |
|   2193838982 |   6210 |     31751 |       1680 | COMBO 1                 |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 1995-04-21 | 2012-10-02 |
|   2193838982 |   6210 |     31751 |       1680 | COMBO 1                 |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 1995-04-21 | 2012-10-02 |
|   2193838982 |   6210 |     31751 |       1680 | COMBO 1                 |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 1995-04-21 | 2012-10-02 |
|   2193838982 |   6210 |     31751 |       1680 | COMBO 1                 |           8 | COMBO-MOD-INGRD-MINUS   |       0.00 |         0.00 |          0.00 |   0.00 | 1995-04-21 | 2012-10-02 |
|   2193838982 |   6210 |     31751 |         -1 | N/A                     |          14 | TAX-LINE                |       0.00 |         0.00 |          0.00 |   0.35 | 1995-04-21 | 2012-10-02 |
|   2193838982 |   6210 |     31751 |       1680 | COMBO 1                 |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 1995-04-21 | 2012-10-02 |
|   2193838982 |   6210 |     31751 |         -1 | N/A                     |          14 | TAX-LINE                |       0.00 |         0.00 |          0.00 |   0.35 | 1995-04-21 | 2012-10-02 |
|   2193838982 |   6210 |     31751 |       1680 | COMBO 1                 |           8 | COMBO-MOD-INGRD-MINUS   |       0.00 |         0.00 |          0.00 |   0.00 | 1995-04-21 | 2012-10-02 |
|   2193838982 |   6210 |     31751 |       3233 | MILD SAUCE              |           2 | NON-COMBO-ITEM          |       1.00 |         0.00 |          0.00 |   0.00 | 1995-04-21 | 2012-10-02 |
|   2193838982 |   6210 |     31751 |       1680 | COMBO 1                 |           1 | COMBO-ITEM              |       1.00 |         4.19 |          4.19 |   0.00 | 1995-04-21 | 2012-10-02 |
|   2193838982 |   6210 |     31751 |       1680 | COMBO 1                 |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 1995-04-21 | 2012-10-02 |
|   2193838982 |   6210 |     31751 |       1680 | COMBO 1                 |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 1995-04-21 | 2012-10-02 |
|   2193838982 |   6210 |     31751 |       3233 | MILD SAUCE              |           2 | NON-COMBO-ITEM          |       1.00 |         0.00 |          0.00 |   0.00 | 1995-04-21 | 2012-10-02 |
+--------------+--------+-----------+------------+-------------------------+-------------+-------------------------+------------+--------------+---------------+--------+------------+------------+
*/

-- connect product_dim and product_group_det
select p.DW_PRODUCT, p.PRODUCTDESC, p.DW_PRODUCTGROUP, d.PRODUCTGROUPDESC
from PRODUCT_DIM p
	left join PRODUCT_GROUP_DET d using(DW_PRODUCTGROUP)
where PRODUCTDESC="COMBO 4";
/*
+------------+-------------+-----------------+------------------+
| DW_PRODUCT | PRODUCTDESC | DW_PRODUCTGROUP | PRODUCTGROUPDESC |
+------------+-------------+-----------------+------------------+
|       1673 | COMBO 4     |              29 | COMBOS           |
|       2271 | COMBO 4     |              29 | COMBOS           |
|       1738 | COMBO 4     |              29 | COMBOS           |
|       1642 | COMBO 4     |              29 | COMBOS           |
|       1689 | COMBO 4     |              29 | COMBOS           |
|      36572 | COMBO 4     |              29 | COMBOS           |
|       3129 | COMBO 4     |              29 | COMBOS           |
|       4512 | COMBO 4     |              29 | COMBOS           |
+------------+-------------+-----------------+------------------+
*/

-- columns in question
-- DW_CHANNEL, DW_GC_HEADER
describe LINEITEM_SEQ_DIM;
/*
+----------------+-------------+------+-----+---------+-------+
| Field          | Type        | Null | Key | Default | Extra |
+----------------+-------------+------+-----+---------+-------+
| DW_LINEITEMSEQ | smallint(6) | NO   | PRI | NULL    |       |
| LINEITEMSEQ    | smallint(6) | NO   |     | NULL    |       |
+----------------+-------------+------+-----+---------+-------+
*/

select * from LINEITEM_SEQ_DIM; --nothing useful

-- use TLD_FACT_2015_Q01 as an example
select t.DW_GC_HEADER, t.DW_DAY, t.DW_RESTID, t.DW_PRODUCT, t.DW_LINEITEM, t.ACTQTYSOLD, t.ACTPRODPRICE, t.ACTGROSSSALES, t.ACTTAX, a.OPENEDDT, a.CLOSEDDT
from TLD_FACT_2015_Q01 t
    left join ALIGN_DIM a using (DW_RESTID)
where OPENEDDT!="0000-00-00"
	and CLOSEDDT="0000-00-00"
limit 20;
/*
+--------------+--------+-----------+------------+-------------+------------+--------------+---------------+--------+------------+------------+
| DW_GC_HEADER | DW_DAY | DW_RESTID | DW_PRODUCT | DW_LINEITEM | ACTQTYSOLD | ACTPRODPRICE | ACTGROSSSALES | ACTTAX | OPENEDDT   | CLOSEDDT   |
+--------------+--------+-----------+------------+-------------+------------+--------------+---------------+--------+------------+------------+
|   7008434308 |   9196 |    150215 |      37591 |           4 |       1.00 |         0.00 |          0.00 |   0.00 | 2006-03-15 | 0000-00-00 |
|   7008434308 |   9196 |    150215 |       1692 |           3 |       1.00 |         0.00 |          0.00 |   0.00 | 2006-03-15 | 0000-00-00 |
|   7008434308 |   9196 |    150215 |      37667 |           2 |       3.00 |         1.69 |          5.07 |   0.00 | 2006-03-15 | 0000-00-00 |
|   7008434492 |   9196 |    150216 |        802 |           2 |       1.00 |         1.19 |          1.19 |   0.00 | 2006-03-15 | 0000-00-00 |
|   7008434492 |   9196 |    150216 |      36021 |           1 |       1.00 |         4.29 |          4.29 |   0.00 | 2006-03-15 | 0000-00-00 |
|   7008434492 |   9196 |    150216 |      36021 |           3 |       1.00 |         0.00 |          0.00 |   0.00 | 2006-03-15 | 0000-00-00 |
|   7008434492 |   9196 |    150216 |      36935 |           2 |       1.00 |         3.39 |          3.39 |   0.00 | 2006-03-15 | 0000-00-00 |
|   7008434216 |   9196 |    150215 |       1689 |           3 |       1.00 |         0.00 |          0.00 |   0.00 | 2006-03-15 | 0000-00-00 |
|   7008434216 |   9196 |    150215 |      36021 |           3 |       1.00 |         0.00 |          0.00 |   0.00 | 2006-03-15 | 0000-00-00 |
|   7008434262 |   9196 |    150215 |       3354 |          11 |       0.00 |         0.00 |          0.00 |   0.00 | 2006-03-15 | 0000-00-00 |
|   7008434262 |   9196 |    150215 |       3354 |          11 |       0.00 |         0.00 |          0.00 |   0.00 | 2006-03-15 | 0000-00-00 |
|   7008434308 |   9196 |    150215 |      37591 |           1 |       1.00 |         7.18 |          7.18 |   0.00 | 2006-03-15 | 0000-00-00 |
|   7008434308 |   9196 |    150215 |       1692 |           1 |       1.00 |         5.69 |          5.69 |   0.00 | 2006-03-15 | 0000-00-00 |
|   7008434308 |   9196 |    150215 |      37202 |           2 |       3.00 |         1.69 |          5.07 |   0.00 | 2006-03-15 | 0000-00-00 |
+--------------+--------+-----------+------------+-------------+------------+--------------+---------------+--------+------------+------------+
*/

select * from TLD_FACT_2015_Q01 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492 order by DW_GC_HEADER; --runtime: 
/*
+--------------+--------+-----------+-----------+-------------+---------------+----------------+----------------------+------------+------------------+---------------+-------------+-------------+--------------+---------+------------+-------------+-----------+------------+--------------+---------------+-------------+---------------+--------------+--------+------------+---------------------------------+
| DW_GC_HEADER | DW_DAY | DW_MINUTE | DW_RESTID | DW_OCCASION | DW_TENDERTYPE | DW_LINEITEMSEQ | DW_LINEITEMSEQPARENT | DW_PRODUCT | DW_PRODUCTDETAIL | DW_PRODUCTMOD | DW_DISCOUNT | DW_LINEITEM | SEASONFACTOR | COUNTER | ACTQTYSOLD | ACTPROMOQTY | ACTMODQTY | ACTDISCQTY | ACTPRODPRICE | ACTGROSSSALES | ACTNETSALES | ACTPROMOSALES | ACTDISCSALES | ACTTAX | DW_CHANNEL | DW_CHECK_IN_LOCATION_IDENTIFIER |
+--------------+--------+-----------+-----------+-------------+---------------+----------------+----------------------+------------+------------------+---------------+-------------+-------------+--------------+---------+------------+-------------+-----------+------------+--------------+---------------+-------------+---------------+--------------+--------+------------+---------------------------------+
|   7008434308 |   9196 |      1377 |    150215 |           2 |             1 |             10 |                    8 |      37591 |            38194 |            -1 |          -1 |           4 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         0.00 |          0.00 |        0.00 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   7008434308 |   9196 |      1377 |    150215 |           2 |             1 |             12 |                    8 |      37591 |             4001 |            -1 |          -1 |           6 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         0.00 |          0.00 |        0.00 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   7008434308 |   9196 |      1377 |    150215 |           2 |             1 |              5 |                    4 |       1692 |             4001 |          2948 |          -1 |           8 |       1.0000 |       1 |       0.00 |           0 |       1.0 |          0 |         0.00 |          0.00 |        0.00 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   7008434308 |   9196 |      1377 |    150215 |           2 |             1 |             15 |                    8 |      37591 |            27270 |            -1 |          -1 |           3 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         0.00 |          0.00 |        0.00 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   7008434308 |   9196 |      1377 |    150215 |           2 |             1 |             13 |                    8 |      37591 |            34596 |            -1 |          -1 |           3 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         0.00 |          0.00 |        0.00 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   7008434308 |   9196 |      1377 |    150215 |           2 |             1 |              4 |                    1 |       1692 |             4001 |            -1 |          -1 |           6 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         0.00 |          0.00 |        0.00 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   7008434308 |   9196 |      1377 |    150215 |           2 |             1 |             16 |                   16 |      37202 |            37202 |            -1 |          -1 |           2 |       1.0000 |       1 |       3.00 |           0 |       0.0 |          0 |         1.69 |          5.07 |        5.07 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   7008434308 |   9196 |      1377 |    150215 |           2 |             1 |              1 |                    1 |       1692 |             1692 |            -1 |          -1 |           1 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         5.69 |          5.69 |        5.69 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   7008434308 |   9196 |      1377 |    150215 |           2 |             1 |              8 |                    8 |      37591 |            37591 |            -1 |          -1 |           1 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         7.18 |          7.18 |        7.18 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   7008434308 |   9196 |      1377 |    150215 |           2 |             1 |            999 |                  999 |         -1 |               -1 |            -1 |          -1 |          14 |       1.0000 |       1 |       0.00 |           0 |       0.0 |          0 |         0.00 |          0.00 |        0.00 |          0.00 |         0.00 |   1.61 |          1 |                              -1 |
|   7008434308 |   9196 |      1377 |    150215 |           2 |             1 |             17 |                   17 |      37667 |            37667 |            -1 |          -1 |           2 |       1.0000 |       1 |       3.00 |           0 |       0.0 |          0 |         1.69 |          5.07 |        5.07 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   7008434308 |   9196 |      1377 |    150215 |           2 |             1 |              7 |                    1 |       1692 |            27249 |            -1 |          -1 |           3 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         0.00 |          0.00 |        0.00 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   7008434308 |   9196 |      1377 |    150215 |           2 |             1 |              2 |                    1 |       1692 |             3844 |            -1 |          -1 |           3 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         0.00 |          0.00 |        0.00 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   7008434492 |   9196 |       816 |    150216 |           2 |             3 |              4 |                    1 |      36021 |            35519 |            -1 |          -1 |           3 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         0.00 |          0.00 |        0.00 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   7008434492 |   9196 |       816 |    150216 |           2 |             3 |              8 |                    5 |      36021 |             2171 |            -1 |          -1 |           3 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         0.00 |          0.00 |        0.00 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   7008434492 |   9196 |       816 |    150216 |           2 |             3 |              2 |                    1 |      36021 |            35930 |            -1 |          -1 |           3 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         0.00 |          0.00 |        0.00 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   7008434492 |   9196 |       816 |    150216 |           2 |             3 |              6 |                    5 |      36021 |            35930 |            -1 |          -1 |           3 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         0.00 |          0.00 |        0.00 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   7008434492 |   9196 |       816 |    150216 |           2 |             3 |              3 |                    1 |      36021 |            35518 |            -1 |          -1 |           3 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         0.00 |          0.00 |        0.00 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   7008434492 |   9196 |       816 |    150216 |           2 |             3 |              1 |                    1 |      36021 |            36021 |            -1 |          -1 |           1 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         4.29 |          4.29 |        4.29 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   7008434492 |   9196 |       816 |    150216 |           2 |             3 |              9 |                    9 |      36989 |            36989 |            -1 |          -1 |           2 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         1.79 |          1.79 |        1.79 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   7008434492 |   9196 |       816 |    150216 |           2 |             3 |             10 |                   10 |      36935 |            36935 |            -1 |          -1 |           2 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         3.39 |          3.39 |        3.39 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   7008434492 |   9196 |       816 |    150216 |           2 |             3 |              7 |                    5 |      36021 |             2144 |            -1 |          -1 |           3 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         0.00 |          0.00 |        0.00 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   7008434492 |   9196 |       816 |    150216 |           2 |             3 |              5 |                    5 |      36021 |            36021 |            -1 |          -1 |           1 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         4.29 |          4.29 |        4.29 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   7008434492 |   9196 |       816 |    150216 |           2 |             3 |             11 |                   11 |        802 |              802 |            -1 |          -1 |           2 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         1.19 |          1.19 |        1.19 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   7008434492 |   9196 |       816 |    150216 |           2 |             3 |            999 |                  999 |         -1 |               -1 |            -1 |          -1 |          14 |       1.0000 |       1 |       0.00 |           0 |       0.0 |          0 |         0.00 |          0.00 |        0.00 |          0.00 |         0.00 |   1.05 |          1 |                              -1 |
+--------------+--------+-----------+-----------+-------------+---------------+----------------+----------------------+------------+------------------+---------------+-------------+-------------+--------------+---------+------------+-------------+-----------+------------+--------------+---------------+-------------+---------------+--------------+--------+------------+---------------------------------+
*/

-- compare records from quarterly table and master
select t.DW_GC_HEADER, t.DW_DAY, t.DW_RESTID, o.DW_OCCASION, o.OCCASIONDESC, t.DW_PRODUCT, p.PRODUCTDESC, t.DW_PRODUCTDETAIL, t.DW_PRODUCTMOD, t.DW_LINEITEM, l.LINEITEMDESC, t.DW_LINEITEMSEQ, t.DW_LINEITEMSEQPARENT, t.ACTQTYSOLD, t.ACTPRODPRICE, t.ACTGROSSSALES, t.ACTTAX
from TLD_FACT_2015_Q01 t
    left join LINEITEM_DIM l using (DW_LINEITEM)
    left join PRODUCT_DIM p using (DW_PRODUCT)
	left join OCCASION_DIM o using (DW_OCCASION)
where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492
order by DW_GC_HEADER, DW_PRODUCT;
/*

+--------------+--------+-----------+-------------+--------------+------------+--------------------------+------------------+---------------+-------------+-------------------------+----------------+----------------------+------------+--------------+---------------+--------+
| DW_GC_HEADER | DW_DAY | DW_RESTID | DW_OCCASION | OCCASIONDESC | DW_PRODUCT | PRODUCTDESC              | DW_PRODUCTDETAIL | DW_PRODUCTMOD | DW_LINEITEM | LINEITEMDESC            | DW_LINEITEMSEQ | DW_LINEITEMSEQPARENT | ACTQTYSOLD | ACTPRODPRICE | ACTGROSSSALES | ACTTAX |
+--------------+--------+-----------+-------------+--------------+------------+--------------------------+------------------+---------------+-------------+-------------------------+----------------+----------------------+------------+--------------+---------------+--------+
|   7008434308 |   9196 |    150215 |           2 | DRIVE-THRU   |         -1 | N/A                      |               -1 |            -1 |          14 | TAX-LINE                |            999 |                  999 |       0.00 |         0.00 |          0.00 |   1.61 |
|   7008434308 |   9196 |    150215 |           2 | DRIVE-THRU   |       1692 | COMBO 7                  |            27249 |            -1 |           3 | COMBO-DETAIL            |              7 |                    1 |       1.00 |         0.00 |          0.00 |   0.00 |
|   7008434308 |   9196 |    150215 |           2 | DRIVE-THRU   |       1692 | COMBO 7                  |             3844 |            -1 |           3 | COMBO-DETAIL            |              2 |                    1 |       1.00 |         0.00 |          0.00 |   0.00 |
|   7008434308 |   9196 |    150215 |           2 | DRIVE-THRU   |       1692 | COMBO 7                  |             4001 |            -1 |           6 | COMBO-DETAIL-REPLS-EQL  |              4 |                    1 |       1.00 |         0.00 |          0.00 |   0.00 |
|   7008434308 |   9196 |    150215 |           2 | DRIVE-THRU   |       1692 | COMBO 7                  |             4001 |          2948 |           8 | COMBO-MOD-INGRD-MINUS   |              5 |                    4 |       0.00 |         0.00 |          0.00 |   0.00 |
|   7008434308 |   9196 |    150215 |           2 | DRIVE-THRU   |       1692 | COMBO 7                  |             1692 |            -1 |           1 | COMBO-ITEM              |              1 |                    1 |       1.00 |         5.69 |          5.69 |   0.00 |
|   7008434308 |   9196 |    150215 |           2 | DRIVE-THRU   |      37202 | CRWRP SLDR CHD           |            37202 |            -1 |           2 | NON-COMBO-ITEM          |             16 |                   16 |       3.00 |         1.69 |          5.07 |   0.00 |
|   7008434308 |   9196 |    150215 |           2 | DRIVE-THRU   |      37591 | QUESARITO BOX            |            38194 |            -1 |           4 | COMBO-DETAIL-REPLS-PLUS |             10 |                    8 |       1.00 |         0.00 |          0.00 |   0.00 |
|   7008434308 |   9196 |    150215 |           2 | DRIVE-THRU   |      37591 | QUESARITO BOX            |            37591 |            -1 |           1 | COMBO-ITEM              |              8 |                    8 |       1.00 |         7.18 |          7.18 |   0.00 |
|   7008434308 |   9196 |    150215 |           2 | DRIVE-THRU   |      37591 | QUESARITO BOX            |            27270 |            -1 |           3 | COMBO-DETAIL            |             15 |                    8 |       1.00 |         0.00 |          0.00 |   0.00 |
|   7008434308 |   9196 |    150215 |           2 | DRIVE-THRU   |      37591 | QUESARITO BOX            |            34596 |            -1 |           3 | COMBO-DETAIL            |             13 |                    8 |       1.00 |         0.00 |          0.00 |   0.00 |
|   7008434308 |   9196 |    150215 |           2 | DRIVE-THRU   |      37591 | QUESARITO BOX            |             4001 |            -1 |           6 | COMBO-DETAIL-REPLS-EQL  |             12 |                    8 |       1.00 |         0.00 |          0.00 |   0.00 |
|   7008434308 |   9196 |    150215 |           2 | DRIVE-THRU   |      37667 | CW SLDR SPICY SC         |            37667 |            -1 |           2 | NON-COMBO-ITEM          |             17 |                   17 |       3.00 |         1.69 |          5.07 |   0.00 |
|   7008434492 |   9196 |    150216 |           2 | DRIVE-THRU   |         -1 | N/A                      |               -1 |            -1 |          14 | TAX-LINE                |            999 |                  999 |       0.00 |         0.00 |          0.00 |   1.05 |
|   7008434492 |   9196 |    150216 |           2 | DRIVE-THRU   |        802 | BEAN BURRITO             |              802 |            -1 |           2 | NON-COMBO-ITEM          |             11 |                   11 |       1.00 |         1.19 |          1.19 |   0.00 |
|   7008434492 |   9196 |    150216 |           2 | DRIVE-THRU   |      36021 | ROLLED CK 4-PK           |            35930 |            -1 |           3 | COMBO-DETAIL            |              6 |                    5 |       1.00 |         0.00 |          0.00 |   0.00 |
|   7008434492 |   9196 |    150216 |           2 | DRIVE-THRU   |      36021 | ROLLED CK 4-PK           |            35930 |            -1 |           3 | COMBO-DETAIL            |              2 |                    1 |       1.00 |         0.00 |          0.00 |   0.00 |
|   7008434492 |   9196 |    150216 |           2 | DRIVE-THRU   |      36021 | ROLLED CK 4-PK           |             2171 |            -1 |           3 | COMBO-DETAIL            |              8 |                    5 |       1.00 |         0.00 |          0.00 |   0.00 |
|   7008434492 |   9196 |    150216 |           2 | DRIVE-THRU   |      36021 | ROLLED CK 4-PK           |            35519 |            -1 |           3 | COMBO-DETAIL            |              4 |                    1 |       1.00 |         0.00 |          0.00 |   0.00 |
|   7008434492 |   9196 |    150216 |           2 | DRIVE-THRU   |      36021 | ROLLED CK 4-PK           |            36021 |            -1 |           1 | COMBO-ITEM              |              5 |                    5 |       1.00 |         4.29 |          4.29 |   0.00 |
|   7008434492 |   9196 |    150216 |           2 | DRIVE-THRU   |      36021 | ROLLED CK 4-PK           |             2144 |            -1 |           3 | COMBO-DETAIL            |              7 |                    5 |       1.00 |         0.00 |          0.00 |   0.00 |
|   7008434492 |   9196 |    150216 |           2 | DRIVE-THRU   |      36021 | ROLLED CK 4-PK           |            36021 |            -1 |           1 | COMBO-ITEM              |              1 |                    1 |       1.00 |         4.29 |          4.29 |   0.00 |
|   7008434492 |   9196 |    150216 |           2 | DRIVE-THRU   |      36021 | ROLLED CK 4-PK           |            35518 |            -1 |           3 | COMBO-DETAIL            |              3 |                    1 |       1.00 |         0.00 |          0.00 |   0.00 |
|   7008434492 |   9196 |    150216 |           2 | DRIVE-THRU   |      36935 | QUESARITO STEAK          |            36935 |            -1 |           2 | NON-COMBO-ITEM          |             10 |                   10 |       1.00 |         3.39 |          3.39 |   0.00 |
|   7008434492 |   9196 |    150216 |           2 | DRIVE-THRU   |      36989 | SHREDDED CHICKEN BURRITO |            36989 |            -1 |           2 | NON-COMBO-ITEM          |              9 |                    9 |       1.00 |         1.79 |          1.79 |   0.00 |
+--------------+--------+-----------+-------------+--------------+------------+--------------------------+------------------+---------------+-------------+-------------------------+----------------+----------------------+------------+--------------+---------------+--------+

*/

select t.DW_GC_HEADER, t.DW_DAY, t.DW_RESTID, o.DW_OCCASION, o.OCCASIONDESC, t.DW_PRODUCT, p.PRODUCTDESC, t.DW_PRODUCTDETAIL, t.DW_PRODUCTMOD, t.DW_LINEITEM, l.LINEITEMDESC, t.DW_LINEITEMSEQ, t.DW_LINEITEMSEQPARENT, t.ACTQTYSOLD, t.ACTPRODPRICE, t.ACTGROSSSALES, t.ACTTAX
from TLD_FACT t
    left join LINEITEM_DIM l using (DW_LINEITEM)
    left join PRODUCT_DIM p using (DW_PRODUCT)
	left join OCCASION_DIM o using (DW_OCCASION)
where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492
order by DW_GC_HEADER, DW_PRODUCT; -- table empty

-- tab number of transactions in master and quarterly tables
select
	(select count(*) from TLD_FACT) as total,
	(select count(*) from TLD_FACT_2007_Q01) as 07q1,
	(select count(*) from TLD_FACT_2007_Q02) as 07q2,
	(select count(*) from TLD_FACT_2007_Q03) as 07q3,
	(select count(*) from TLD_FACT_2007_Q04) as 07q4,
	(select count(*) from TLD_FACT_2008_Q01) as 08q1,
	(select count(*) from TLD_FACT_2008_Q02) as 08q2,
	(select count(*) from TLD_FACT_2008_Q03) as 08q3,
	(select count(*) from TLD_FACT_2008_Q04) as 08q4,
	(select count(*) from TLD_FACT_2009_Q01) as 09q1,
	(select count(*) from TLD_FACT_2009_Q02) as 09q2,
	(select count(*) from TLD_FACT_2009_Q03) as 09q3,
	(select count(*) from TLD_FACT_2009_Q04) as 09q4,
	(select count(*) from TLD_FACT_2010_Q01) as 10q1,
	(select count(*) from TLD_FACT_2010_Q02) as 10q2,
	(select count(*) from TLD_FACT_2010_Q03) as 10q3,
	(select count(*) from TLD_FACT_2010_Q04) as 10q4,
	(select count(*) from TLD_FACT_2011_Q01) as 11q1,
	(select count(*) from TLD_FACT_2011_Q02) as 11q2,
	(select count(*) from TLD_FACT_2011_Q03) as 11q3,
	(select count(*) from TLD_FACT_2011_Q04) as 11q4,
	(select count(*) from TLD_FACT_2012_Q01) as 12q1,
	(select count(*) from TLD_FACT_2012_Q02) as 12q2,
	(select count(*) from TLD_FACT_2012_Q03) as 12q3,
	(select count(*) from TLD_FACT_2012_Q04) as 12q4,
	(select count(*) from TLD_FACT_2013_Q01) as 13q1,
	(select count(*) from TLD_FACT_2013_Q02) as 13q2,
	(select count(*) from TLD_FACT_2013_Q03) as 13q3,
	(select count(*) from TLD_FACT_2013_Q04) as 13q4,
	(select count(*) from TLD_FACT_2014_Q01) as 14q1,
	(select count(*) from TLD_FACT_2014_Q02) as 14q2,
	(select count(*) from TLD_FACT_2014_Q03) as 14q3,
	(select count(*) from TLD_FACT_2014_Q04) as 14q4,
	(select count(*) from TLD_FACT_2015_Q01) as 15q1,
	(select count(*) from TLD_FACT_2015_Q02) as 15q2,
	(select count(*) from TLD_FACT_2015_Q03) as 15q3;
/*
+------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+------------+------------+------------+------------+------------+-----------+------------+------------+------------+------------+------------+------------+
| total      | 07q1      | 07q2      | 07q3      | 07q4      | 08q1      | 08q2      | 08q3      | 08q4      | 09q1      | 09q2      | 09q3      | 09q4      | 10q1      | 10q2      | 10q3      | 10q4      | 11q1      | 11q2      | 11q3      | 11q4      | 12q1      | 12q2      | 12q3      | 12q4       | 13q1       | 13q2       | 13q3       | 13q4       | 14q1      | 14q2       | 14q3       | 14q4       | 15q1       | 15q2       | 15q3       |
+------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+------------+------------+------------+------------+------------+-----------+------------+------------+------------+------------+------------+------------+
| 4965182657 | 727957470 | 410591488 | 408919477 | 525394470 | 393761041 | 436986687 | 465021041 | 608088041 | 414278381 | 456293970 | 461288824 | 794410882 | 652860758 | 702903894 | 722179580 | 875304412 | 584204423 | 613618156 | 604264985 | 810326023 | 605991280 | 818032696 | 940370314 | 1239434138 | 1001924881 | 1152821407 | 1240517750 | 1556274400 | 806956251 | 1227420117 | 1240061145 | 1651024877 | 1207030560 | 1325307922 | 1353794936 |
+------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+------------+------------+------------+------------+------------+-----------+------------+------------+------------+------------+------------+------------+
*/	

select
	(select count(*) from TLD_FACT where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as total,
	(select count(*) from TLD_FACT_2007_Q01 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 07q1,
	(select count(*) from TLD_FACT_2007_Q02 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 07q2,
	(select count(*) from TLD_FACT_2007_Q03 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 07q3,
	(select count(*) from TLD_FACT_2007_Q04 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 07q4,
	(select count(*) from TLD_FACT_2008_Q01 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 08q1,
	(select count(*) from TLD_FACT_2008_Q02 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 08q2,
	(select count(*) from TLD_FACT_2008_Q03 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 08q3,
	(select count(*) from TLD_FACT_2008_Q04 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 08q4,
	(select count(*) from TLD_FACT_2009_Q01 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 09q1,
	(select count(*) from TLD_FACT_2009_Q02 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 09q2,
	(select count(*) from TLD_FACT_2009_Q03 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 09q3,
	(select count(*) from TLD_FACT_2009_Q04 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 09q4,
	(select count(*) from TLD_FACT_2010_Q01 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 10q1,
	(select count(*) from TLD_FACT_2010_Q02 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 10q2,
	(select count(*) from TLD_FACT_2010_Q03 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 10q3,
	(select count(*) from TLD_FACT_2010_Q04 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 10q4,
	(select count(*) from TLD_FACT_2011_Q01 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 11q1,
	(select count(*) from TLD_FACT_2011_Q02 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 11q2,
	(select count(*) from TLD_FACT_2011_Q03 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 11q3,
	(select count(*) from TLD_FACT_2011_Q04 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 11q4,
	(select count(*) from TLD_FACT_2012_Q01 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 12q1,
	(select count(*) from TLD_FACT_2012_Q02 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 12q2,
	(select count(*) from TLD_FACT_2012_Q03 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 12q3,
	(select count(*) from TLD_FACT_2012_Q04 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 12q4,
	(select count(*) from TLD_FACT_2013_Q01 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 13q1,
	(select count(*) from TLD_FACT_2013_Q02 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 13q2,
	(select count(*) from TLD_FACT_2013_Q03 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 13q3,
	(select count(*) from TLD_FACT_2013_Q04 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 13q4,
	(select count(*) from TLD_FACT_2014_Q01 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 14q1,
	(select count(*) from TLD_FACT_2014_Q02 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 14q2,
	(select count(*) from TLD_FACT_2014_Q03 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 14q3,
	(select count(*) from TLD_FACT_2014_Q04 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 14q4,
	(select count(*) from TLD_FACT_2015_Q01 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 15q1,
	(select count(*) from TLD_FACT_2015_Q02 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 15q2,
	(select count(*) from TLD_FACT_2015_Q03 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 15q3;
/* only available in 15Q1
+-------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+
| total | 07q1 | 07q2 | 07q3 | 07q4 | 08q1 | 08q2 | 08q3 | 08q4 | 09q1 | 09q2 | 09q3 | 09q4 | 10q1 | 10q2 | 10q3 | 10q4 | 11q1 | 11q2 | 11q3 | 11q4 | 12q1 | 12q2 | 12q3 | 12q4 | 13q1 | 13q2 | 13q3 | 13q4 | 14q1 | 14q2 | 14q3 | 14q4 | 15q1 | 15q2 | 15q3 |
+-------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+
|     0 |    0 |    0 |    0 |    0 |    0 |    0 |    0 |    0 |    0 |    0 |    0 |    0 |    0 |    0 |    0 |    0 |    0 |    0 |    0 |    0 |    0 |    0 |    0 |    0 |    0 |    0 |    0 |    0 |    0 |    0 |    0 |    0 |   25 |    0 |    0 |
+-------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+
1 row in set (1 hour 54 min 23.65 sec)
*/

select count(distinct DW_GC_HEADER) from TLD_FACT;

-- check what transactions from quarterly tables are also available in master
select count(*) from GC_HEADER_DIM_2010_Q01;

select
	/*(select DW_GC_HEADER from TLD_FACT) as total,*/
	(select DW_GC_HEADER from TLD_FACT_2007_Q01 limit 1) as 07q1,
	(select DW_GC_HEADER from TLD_FACT_2007_Q02 limit 1) as 07q2,
	(select DW_GC_HEADER from TLD_FACT_2007_Q03 limit 1) as 07q3,
	(select DW_GC_HEADER from TLD_FACT_2007_Q04 limit 1) as 07q4,
	(select DW_GC_HEADER from TLD_FACT_2008_Q01 limit 1) as 08q1,
	(select DW_GC_HEADER from TLD_FACT_2008_Q02 limit 1) as 08q2,
	(select DW_GC_HEADER from TLD_FACT_2008_Q03 limit 1) as 08q3,
	(select DW_GC_HEADER from TLD_FACT_2008_Q04 limit 1) as 08q4,
	(select DW_GC_HEADER from TLD_FACT_2009_Q01 limit 1) as 09q1,
	(select DW_GC_HEADER from TLD_FACT_2009_Q02 limit 1) as 09q2,
	(select DW_GC_HEADER from TLD_FACT_2009_Q03 limit 1) as 09q3,
	(select DW_GC_HEADER from TLD_FACT_2009_Q04 limit 1) as 09q4,
	(select DW_GC_HEADER from TLD_FACT_2010_Q01 limit 1) as 10q1,
	(select DW_GC_HEADER from TLD_FACT_2010_Q02 limit 1) as 10q2,
	(select DW_GC_HEADER from TLD_FACT_2010_Q03 limit 1) as 10q3,
	(select DW_GC_HEADER from TLD_FACT_2010_Q04 limit 1) as 10q4,
	(select DW_GC_HEADER from TLD_FACT_2011_Q01 limit 1) as 11q1,
	(select DW_GC_HEADER from TLD_FACT_2011_Q02 limit 1) as 11q2,
	(select DW_GC_HEADER from TLD_FACT_2011_Q03 limit 1) as 11q3,
	(select DW_GC_HEADER from TLD_FACT_2011_Q04 limit 1) as 11q4,
	(select DW_GC_HEADER from TLD_FACT_2012_Q01 limit 1) as 12q1,
	(select DW_GC_HEADER from TLD_FACT_2012_Q02 limit 1) as 12q2,
	(select DW_GC_HEADER from TLD_FACT_2012_Q03 limit 1) as 12q3,
	(select DW_GC_HEADER from TLD_FACT_2012_Q04 limit 1) as 12q4,
	(select DW_GC_HEADER from TLD_FACT_2013_Q01 limit 1) as 13q1,
	(select DW_GC_HEADER from TLD_FACT_2013_Q02 limit 1) as 13q2,
	(select DW_GC_HEADER from TLD_FACT_2013_Q03 limit 1) as 13q3,
	(select DW_GC_HEADER from TLD_FACT_2013_Q04 limit 1) as 13q4,
	(select DW_GC_HEADER from TLD_FACT_2014_Q01 limit 1) as 14q1,
	(select DW_GC_HEADER from TLD_FACT_2014_Q02 limit 1) as 14q2,
	(select DW_GC_HEADER from TLD_FACT_2014_Q03 limit 1) as 14q3,
	(select DW_GC_HEADER from TLD_FACT_2014_Q04 limit 1) as 14q4,
	(select DW_GC_HEADER from TLD_FACT_2015_Q01 limit 1) as 15q1,
	(select DW_GC_HEADER from TLD_FACT_2015_Q02 limit 1) as 15q2,
	(select DW_GC_HEADER from TLD_FACT_2015_Q03 limit 1) as 15q3;
/*
+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| 07q1       | 07q2       | 07q3       | 07q4       | 08q1       | 08q2       | 08q3       | 08q4       | 09q1       | 09q2       | 09q3       | 09q4       | 10q1       | 10q2       | 10q3       | 10q4       | 11q1       | 11q2       | 11q3       | 11q4       | 12q1       | 12q2       | 12q3       | 12q4       | 13q1       | 13q2       | 13q3       | 13q4       | 14q1       | 14q2       | 14q3       | 14q4       | 15q1       | 15q2       | 15q3       |
+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| 2193837694 | 2268477652 | 2370598056 | 2440911143 | 2531798051 | 2600038097 | 2675062530 | 2757114830 | 2864539602 | 2938503743 | 3020978631 | 3104426534 | 3252234169 | 3370415535 | 3499666135 | 3625863678 | 3782963763 | 3886539517 | 3995506502 | 4106212179 | 4253655046 | 4367247208 | 4519622138 | 4693969274 | 5034512599 | 5171371477 | 5430925256 | 5748548201 | 5833189728 | 6045008582 | 6438545377 | 6552786309 | 7008429708 | 7290376505 | 7452761975 |
+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
1 row in set (0.56 sec)
*/

select
	(select count(*) from TLD_FACT where DW_GC_HEADER=2193837694) as 07q1, --10
	(select count(*) from TLD_FACT where DW_GC_HEADER=2268477652) as 07q2, --0
	(select count(*) from TLD_FACT where DW_GC_HEADER=2370598056) as 07q3, --0
	(select count(*) from TLD_FACT where DW_GC_HEADER=2440911143) as 07q4; --0
select
	(select count(*) from TLD_FACT where DW_GC_HEADER=2531798051) as 08q1, --2
	(select count(*) from TLD_FACT where DW_GC_HEADER=2600038097) as 08q2, --0
	(select count(*) from TLD_FACT where DW_GC_HEADER=2675062530) as 08q3, --0
	(select count(*) from TLD_FACT where DW_GC_HEADER=2757114830) as 08q4; --0
select
	(select count(*) from TLD_FACT where DW_GC_HEADER=2864539602) as 09q1, --10
	(select count(*) from TLD_FACT where DW_GC_HEADER=2938503743) as 09q2, --0
	(select count(*) from TLD_FACT where DW_GC_HEADER=3020978631) as 09q3, --0
	(select count(*) from TLD_FACT where DW_GC_HEADER=3104426534) as 09q4; --0
select
	(select count(*) from TLD_FACT where DW_GC_HEADER=3252234169) as 10q1, --7
	(select count(*) from TLD_FACT where DW_GC_HEADER=3370415535) as 10q2, --0
	(select count(*) from TLD_FACT where DW_GC_HEADER=3499666135) as 10q3, --0
	(select count(*) from TLD_FACT where DW_GC_HEADER=3625863678) as 10q4; --0
select
	(select count(*) from TLD_FACT where DW_GC_HEADER=3782963763) as 11q1, --16
	(select count(*) from TLD_FACT where DW_GC_HEADER=3886539517) as 11q2, --0
	(select count(*) from TLD_FACT where DW_GC_HEADER=3995506502) as 11q3, --0
	(select count(*) from TLD_FACT where DW_GC_HEADER=4106212179) as 11q4; --0
select
	(select count(*) from TLD_FACT where DW_GC_HEADER=4253655046) as 12q1, --4
	(select count(*) from TLD_FACT where DW_GC_HEADER=4367247208) as 12q2, --0
	(select count(*) from TLD_FACT where DW_GC_HEADER=4519622138) as 12q3, --0
	(select count(*) from TLD_FACT where DW_GC_HEADER=4693969274) as 12q4; --0
select
	(select count(*) from TLD_FACT where DW_GC_HEADER=5034512599) as 13q1, --3
	(select count(*) from TLD_FACT where DW_GC_HEADER=5171371477) as 13q2, --0
	(select count(*) from TLD_FACT where DW_GC_HEADER=5430925256) as 13q3, --0
	(select count(*) from TLD_FACT where DW_GC_HEADER=5748548201) as 13q4; --0
select
	(select count(*) from TLD_FACT where DW_GC_HEADER=5833189728) as 14q1, --0
	(select count(*) from TLD_FACT where DW_GC_HEADER=6045008582) as 14q2, --0
	(select count(*) from TLD_FACT where DW_GC_HEADER=6438545377) as 14q3, --0
	(select count(*) from TLD_FACT where DW_GC_HEADER=6552786309) as 14q4; --0
select
	(select count(*) from TLD_FACT where DW_GC_HEADER=7008429708) as 15q1, --0
	(select count(*) from TLD_FACT where DW_GC_HEADER=7290376505) as 15q2, --0
	(select count(*) from TLD_FACT where DW_GC_HEADER=7452761975) as 15q3; --0

-- descriptives
select AGREEMENT_CD, count(*)
from ALIGN_DIM
where CLOSEDDT>="2007-01-01" or CLOSEDDT="0000-00-00"
group by AGREEMENT_CD;

/*
* NEW PRODCT ADDED BY TLD *
FRANCHISE LOCAL MENU
PIZZA HUT
KFC
LJS/LIS?
PHI
AWR
*/
select t.DW_PRODUCT, p.PRODUCTDESC, count(*)
from TLD_FACT_2007_Q01 t
	left join PRODUCT_DIM p using(DW_PRODUCT)
where PRODUCTDESC like ("%* NEW PRODCT ADDED BY TLD *%")
	or PRODUCTDESC like ("%FRANCHISE LOCAL MENU%")
	or PRODUCTDESC like ("KFC%")
	or PRODUCTDESC like ("PIZZA HUT%")
	or PRODUCTDESC like ("PHI%")
	or PRODUCTDESC like ("LJS%")
	or PRODUCTDESC like ("AWR%")
	or PRODUCTDESC like ("%COMBO%")
group by PRODUCTDESC;

--- group by productdesc
select (select count(*) from TLD_FACT_2014_Q01 left join PRODUCT_DIM using(DW_PRODUCT) where PRODUCTDESC like ("%* NEW PRODCT ADDED BY TLD *%")) as newproduct;
select (select count(*) from TLD_FACT_2014_Q01 left join PRODUCT_DIM using(DW_PRODUCT) where PRODUCTDESC like ("%FRANCHISE LOCAL MENU%")) as franchise;
select (select count(*) from TLD_FACT_2014_Q01 left join PRODUCT_DIM using(DW_PRODUCT) where PRODUCTDESC like ("%KFC%") or PRODUCTDESC like ("%PIZZA HUT%") or PRODUCTDESC like ("%PHI%") or PRODUCTDESC like ("%LJS%") or PRODUCTDESC like ("%AWR%")) as otherbrand;

select (select count(*) from TLD_FACT_2014_Q02 left join PRODUCT_DIM using(DW_PRODUCT) where PRODUCTDESC like ("%* NEW PRODCT ADDED BY TLD *%")) as newproduct;
select (select count(*) from TLD_FACT_2014_Q02 left join PRODUCT_DIM using(DW_PRODUCT) where PRODUCTDESC like ("%FRANCHISE LOCAL MENU%")) as franchise;
select (select count(*) from TLD_FACT_2014_Q02 left join PRODUCT_DIM using(DW_PRODUCT) where PRODUCTDESC like ("%KFC%") or PRODUCTDESC like ("%PIZZA HUT%") or PRODUCTDESC like ("%PHI%") or PRODUCTDESC like ("%LJS%") or PRODUCTDESC like ("%AWR%")) as otherbrand;

select (select count(*) from TLD_FACT_2014_Q03 left join PRODUCT_DIM using(DW_PRODUCT) where PRODUCTDESC like ("%* NEW PRODCT ADDED BY TLD *%")) as newproduct;
select (select count(*) from TLD_FACT_2014_Q03 left join PRODUCT_DIM using(DW_PRODUCT) where PRODUCTDESC like ("%FRANCHISE LOCAL MENU%")) as franchise;
select (select count(*) from TLD_FACT_2014_Q03 left join PRODUCT_DIM using(DW_PRODUCT) where PRODUCTDESC like ("%KFC%") or PRODUCTDESC like ("%PIZZA HUT%") or PRODUCTDESC like ("%PHI%") or PRODUCTDESC like ("%LJS%") or PRODUCTDESC like ("%AWR%")) as otherbrand;

select (select count(*) from TLD_FACT_2014_Q04 left join PRODUCT_DIM using(DW_PRODUCT) where PRODUCTDESC like ("%* NEW PRODCT ADDED BY TLD *%")) as newproduct;
select (select count(*) from TLD_FACT_2014_Q04 left join PRODUCT_DIM using(DW_PRODUCT) where PRODUCTDESC like ("%FRANCHISE LOCAL MENU%")) as franchise;
select (select count(*) from TLD_FACT_2014_Q04 left join PRODUCT_DIM using(DW_PRODUCT) where PRODUCTDESC like ("%KFC%") or PRODUCTDESC like ("%PIZZA HUT%") or PRODUCTDESC like ("%PHI%") or PRODUCTDESC like ("%LJS%") or PRODUCTDESC like ("%AWR%")) as otherbrand;

--select (select count(*) from TLD_FACT_2013_Q04 left join PRODUCT_DIM using(DW_PRODUCT) where (PRODUCTDESC like ("%COMBO 1%") or PRODUCTDESC like ("%COMBO 2%") or PRODUCTDESC like ("%COMBO 3%") or PRODUCTDESC like ("%COMBO 4%") or PRODUCTDESC like ("%COMBO 5%") or PRODUCTDESC like ("%COMBO 6%") or PRODUCTDESC like ("%COMBO 7%") or PRODUCTDESC like ("%COMBO 8%") or PRODUCTDESC like ("%COMBO 9%") or PRODUCTDESC like ("%COMBO #10%") or PRODUCTDESC like ("%COMBO 10%") or PRODUCTDESC like ("%COMBO 11%")) and PRODUCTDESC not like ("%KFC%") and PRODUCTDESC not like ("%PHI%") and PRODUCTDESC not like ("%PIZZA HUT%") and PRODUCTDESC not like ("%LJS%") and PRODUCTDESC not like ("%AWR%")) as combo;





-- 
select p.PRODUCTDESC, g.PRODUCTGROUPDESC
from PRODUCT_DIM p
	left join PRODUCT_GROUP_DET g using (DW_PRODUCTGROUP)
where PRODUCTGROUPDESC!="KFC" 
	and PRODUCTGROUPDESC!="PIZZA HUT" 
	and PRODUCTGROUPDESC!="UNASSIGNED"
	and PRODUCTDESC like ("%COMBO %")
order by DW_PRODUCT
limit 50;

/*
2019-08-13 10:48:48	Looking up host "bigpurple.nyumc.org"
2019-08-13 10:48:48	Connecting to 10.189.18.113 port 22
2019-08-13 10:48:48	We claim version: SSH-2.0-PuTTY_Release_0.67
2019-08-13 10:48:48	Server version: SSH-2.0-OpenSSH_7.4
2019-08-13 10:48:48	Using SSH protocol version 2
2019-08-13 10:48:48	Doing Diffie-Hellman group exchange
2019-08-13 10:48:48	Doing Diffie-Hellman key exchange with hash SHA-256
2019-08-13 10:48:48	Host key fingerprint is:
2019-08-13 10:48:48	ssh-rsa 2048 80:97:52:1e:d5:84:7a:31:35:e5:b5:ab:f0:e7:26:6a
2019-08-13 10:48:48	Initialised AES-256 SDCTR client->server encryption
2019-08-13 10:48:48	Initialised HMAC-SHA-256 client->server MAC algorithm
2019-08-13 10:48:48	Initialised AES-256 SDCTR server->client encryption
2019-08-13 10:48:48	Initialised HMAC-SHA-256 server->client MAC algorithm
2019-08-13 10:48:48	Using SSPI from SECUR32.DLL
2019-08-13 10:48:48	Attempting GSSAPI authentication
2019-08-13 10:48:48	GSSAPI authentication initialisation failed
2019-08-13 10:48:48	The target was not recognized.
2019-08-13 10:48:52	Sent password
2019-08-13 10:48:52	Access granted
2019-08-13 10:48:52	Opening session as main channel
2019-08-13 10:48:53	Opened main channel
2019-08-13 10:48:53	Requesting X11 forwarding
2019-08-13 10:48:53	X11 forwarding enabled
2019-08-13 10:48:53	Allocated pty (ospeed 38400bps, ispeed 38400bps)
2019-08-13 10:48:53	Started a shell/command
2019-08-13 11:48:48	Initiating key re-exchange (timeout)
2019-08-13 11:48:48	Doing Diffie-Hellman group exchange
2019-08-13 11:48:48	Doing Diffie-Hellman key exchange with hash SHA-256
2019-08-13 11:48:48	Initialised AES-256 SDCTR client->server encryption
2019-08-13 11:48:48	Initialised HMAC-SHA-256 client->server MAC algorithm
2019-08-13 11:48:48	Initialised AES-256 SDCTR server->client encryption
2019-08-13 11:48:48	Initialised HMAC-SHA-256 server->client MAC algorithm
2019-08-13 12:48:48	Initiating key re-exchange (timeout)
2019-08-13 12:48:48	Doing Diffie-Hellman group exchange
2019-08-13 12:48:48	Doing Diffie-Hellman key exchange with hash SHA-256
2019-08-13 12:48:49	Initialised AES-256 SDCTR client->server encryption
2019-08-13 12:48:49	Initialised HMAC-SHA-256 client->server MAC algorithm
2019-08-13 12:48:49	Initialised AES-256 SDCTR server->client encryption
2019-08-13 12:48:49	Initialised HMAC-SHA-256 server->client MAC algorithm
2019-08-13 13:48:49	Initiating key re-exchange (timeout)
2019-08-13 13:48:49	Doing Diffie-Hellman group exchange
2019-08-13 13:48:49	Doing Diffie-Hellman key exchange with hash SHA-256
2019-08-13 13:48:49	Initialised AES-256 SDCTR client->server encryption
2019-08-13 13:48:49	Initialised HMAC-SHA-256 client->server MAC algorithm
2019-08-13 13:48:49	Initialised AES-256 SDCTR server->client encryption
2019-08-13 13:48:49	Initialised HMAC-SHA-256 server->client MAC algorithm
2019-08-13 14:48:49	Initiating key re-exchange (timeout)
2019-08-13 14:48:49	Doing Diffie-Hellman group exchange
2019-08-13 14:48:49	Doing Diffie-Hellman key exchange with hash SHA-256
2019-08-13 14:48:49	Initialised AES-256 SDCTR client->server encryption
2019-08-13 14:48:49	Initialised HMAC-SHA-256 client->server MAC algorithm
2019-08-13 14:48:49	Initialised AES-256 SDCTR server->client encryption
2019-08-13 14:48:49	Initialised HMAC-SHA-256 server->client MAC algorithm
2019-08-13 15:48:49	Initiating key re-exchange (timeout)
2019-08-13 15:48:49	Doing Diffie-Hellman group exchange
2019-08-13 15:48:49	Doing Diffie-Hellman key exchange with hash SHA-256
2019-08-13 15:48:49	Initialised AES-256 SDCTR client->server encryption
2019-08-13 15:48:49	Initialised HMAC-SHA-256 client->server MAC algorithm
2019-08-13 15:48:49	Initialised AES-256 SDCTR server->client encryption
2019-08-13 15:48:49	Initialised HMAC-SHA-256 server->client MAC algorithm
2019-08-13 16:48:49	Initiating key re-exchange (timeout)
2019-08-13 16:48:49	Doing Diffie-Hellman group exchange
2019-08-13 16:48:49	Doing Diffie-Hellman key exchange with hash SHA-256
2019-08-13 16:48:50	Initialised AES-256 SDCTR client->server encryption
2019-08-13 16:48:50	Initialised HMAC-SHA-256 client->server MAC algorithm
2019-08-13 16:48:50	Initialised AES-256 SDCTR server->client encryption
2019-08-13 16:48:50	Initialised HMAC-SHA-256 server->client MAC algorithm
2019-08-13 17:48:50	Initiating key re-exchange (timeout)
2019-08-13 17:48:50	Doing Diffie-Hellman group exchange
2019-08-13 17:48:50	Doing Diffie-Hellman key exchange with hash SHA-256
2019-08-13 17:48:50	Initialised AES-256 SDCTR client->server encryption
2019-08-13 17:48:50	Initialised HMAC-SHA-256 client->server MAC algorithm
2019-08-13 17:48:50	Initialised AES-256 SDCTR server->client encryption
2019-08-13 17:48:50	Initialised HMAC-SHA-256 server->client MAC algorithm
2019-08-13 18:48:50	Initiating key re-exchange (timeout)
2019-08-13 18:48:50	Doing Diffie-Hellman group exchange
2019-08-13 18:48:50	Doing Diffie-Hellman key exchange with hash SHA-256
2019-08-13 18:48:50	Initialised AES-256 SDCTR client->server encryption
2019-08-13 18:48:50	Initialised HMAC-SHA-256 client->server MAC algorithm
2019-08-13 18:48:50	Initialised AES-256 SDCTR server->client encryption
2019-08-13 18:48:50	Initialised HMAC-SHA-256 server->client MAC algorithm
2019-08-13 19:48:50	Initiating key re-exchange (timeout)
2019-08-13 19:48:50	Doing Diffie-Hellman group exchange
2019-08-13 19:48:50	Doing Diffie-Hellman key exchange with hash SHA-256
2019-08-13 19:48:50	Initialised AES-256 SDCTR client->server encryption
2019-08-13 19:48:50	Initialised HMAC-SHA-256 client->server MAC algorithm
2019-08-13 19:48:50	Initialised AES-256 SDCTR server->client encryption
2019-08-13 19:48:50	Initialised HMAC-SHA-256 server->client MAC algorithm
2019-08-13 20:00:40	Network error: Software caused connection abort
2019-08-14 09:40:10	----- Session restarted -----
2019-08-14 09:40:10	Looking up host "bigpurple.nyumc.org"
2019-08-14 09:40:10	Connecting to 10.189.18.111 port 22
2019-08-14 09:40:10	We claim version: SSH-2.0-PuTTY_Release_0.67
2019-08-14 09:40:10	Server version: SSH-2.0-OpenSSH_7.4
2019-08-14 09:40:10	Using SSH protocol version 2
2019-08-14 09:40:10	Doing Diffie-Hellman group exchange
2019-08-14 09:40:10	Doing Diffie-Hellman key exchange with hash SHA-256
2019-08-14 09:40:10	Host key fingerprint is:
2019-08-14 09:40:10	ssh-rsa 2048 80:97:52:1e:d5:84:7a:31:35:e5:b5:ab:f0:e7:26:6a
2019-08-14 09:40:10	Initialised AES-256 SDCTR client->server encryption
2019-08-14 09:40:10	Initialised HMAC-SHA-256 client->server MAC algorithm
2019-08-14 09:40:10	Initialised AES-256 SDCTR server->client encryption
2019-08-14 09:40:10	Initialised HMAC-SHA-256 server->client MAC algorithm
2019-08-14 09:40:10	Using SSPI from SECUR32.DLL
2019-08-14 09:40:10	Attempting GSSAPI authentication
2019-08-14 09:40:10	GSSAPI authentication initialisation failed
2019-08-14 09:40:10	The target was not recognized.
2019-08-14 09:40:17	Sent password
2019-08-14 09:40:17	Access granted
2019-08-14 09:40:17	Opening session as main channel
2019-08-14 09:40:17	Opened main channel
2019-08-14 09:40:17	Requesting X11 forwarding
2019-08-14 09:40:17	X11 forwarding enabled
2019-08-14 09:40:17	Allocated pty (ospeed 38400bps, ispeed 38400bps)
2019-08-14 09:40:17	Started a shell/command
2019-08-14 10:40:10	Initiating key re-exchange (timeout)
2019-08-14 10:40:10	Doing Diffie-Hellman group exchange
2019-08-14 10:40:10	Doing Diffie-Hellman key exchange with hash SHA-256
2019-08-14 10:40:11	Initialised AES-256 SDCTR client->server encryption
2019-08-14 10:40:11	Initialised HMAC-SHA-256 client->server MAC algorithm
2019-08-14 10:40:11	Initialised AES-256 SDCTR server->client encryption
2019-08-14 10:40:11	Initialised HMAC-SHA-256 server->client MAC algorithm
2019-08-14 11:40:11	Initiating key re-exchange (timeout)
2019-08-14 11:40:11	Doing Diffie-Hellman group exchange
2019-08-14 11:40:11	Doing Diffie-Hellman key exchange with hash SHA-256
2019-08-14 11:40:11	Initialised AES-256 SDCTR client->server encryption
2019-08-14 11:40:11	Initialised HMAC-SHA-256 client->server MAC algorithm
2019-08-14 11:40:11	Initialised AES-256 SDCTR server->client encryption
2019-08-14 11:40:11	Initialised HMAC-SHA-256 server->client MAC algorithm
2019-08-14 12:40:11	Initiating key re-exchange (timeout)
2019-08-14 12:40:11	Doing Diffie-Hellman group exchange
2019-08-14 12:40:11	Doing Diffie-Hellman key exchange with hash SHA-256
2019-08-14 12:40:11	Initialised AES-256 SDCTR client->server encryption
2019-08-14 12:40:11	Initialised HMAC-SHA-256 client->server MAC algorithm
2019-08-14 12:40:11	Initialised AES-256 SDCTR server->client encryption
2019-08-14 12:40:11	Initialised HMAC-SHA-256 server->client MAC algorithm
2019-08-14 13:40:11	Initiating key re-exchange (timeout)
2019-08-14 13:40:11	Doing Diffie-Hellman group exchange
2019-08-14 13:40:11	Doing Diffie-Hellman key exchange with hash SHA-256
2019-08-14 13:40:12	Initialised AES-256 SDCTR client->server encryption
2019-08-14 13:40:12	Initialised HMAC-SHA-256 client->server MAC algorithm
2019-08-14 13:40:12	Initialised AES-256 SDCTR server->client encryption
2019-08-14 13:40:12	Initialised HMAC-SHA-256 server->client MAC algorithm
2019-08-14 14:40:12	Initiating key re-exchange (timeout)
2019-08-14 14:40:12	Doing Diffie-Hellman group exchange
2019-08-14 14:40:12	Doing Diffie-Hellman key exchange with hash SHA-256
2019-08-14 14:40:12	Initialised AES-256 SDCTR client->server encryption
2019-08-14 14:40:12	Initialised HMAC-SHA-256 client->server MAC algorithm
2019-08-14 14:40:12	Initialised AES-256 SDCTR server->client encryption
2019-08-14 14:40:12	Initialised HMAC-SHA-256 server->client MAC algorithm
2019-08-14 15:40:12	Initiating key re-exchange (timeout)
2019-08-14 15:40:12	Doing Diffie-Hellman group exchange
2019-08-14 15:40:12	Doing Diffie-Hellman key exchange with hash SHA-256
2019-08-14 15:40:12	Initialised AES-256 SDCTR client->server encryption
2019-08-14 15:40:12	Initialised HMAC-SHA-256 client->server MAC algorithm
2019-08-14 15:40:12	Initialised AES-256 SDCTR server->client encryption
2019-08-14 15:40:12	Initialised HMAC-SHA-256 server->client MAC algorithm
2019-08-14 16:40:12	Initiating key re-exchange (timeout)
2019-08-14 16:40:12	Doing Diffie-Hellman group exchange
2019-08-14 16:40:12	Doing Diffie-Hellman key exchange with hash SHA-256
2019-08-14 16:40:13	Initialised AES-256 SDCTR client->server encryption
2019-08-14 16:40:13	Initialised HMAC-SHA-256 client->server MAC algorithm
2019-08-14 16:40:13	Initialised AES-256 SDCTR server->client encryption
2019-08-14 16:40:13	Initialised HMAC-SHA-256 server->client MAC algorithm
2019-08-14 17:40:13	Initiating key re-exchange (timeout)
2019-08-14 17:40:13	Doing Diffie-Hellman group exchange
2019-08-14 17:40:13	Doing Diffie-Hellman key exchange with hash SHA-256
2019-08-14 17:40:13	Initialised AES-256 SDCTR client->server encryption
2019-08-14 17:40:13	Initialised HMAC-SHA-256 client->server MAC algorithm
2019-08-14 17:40:13	Initialised AES-256 SDCTR server->client encryption
2019-08-14 17:40:13	Initialised HMAC-SHA-256 server->client MAC algorithm
2019-08-14 18:40:13	Initiating key re-exchange (timeout)
2019-08-14 18:40:13	Doing Diffie-Hellman group exchange
2019-08-14 18:40:13	Doing Diffie-Hellman key exchange with hash SHA-256
2019-08-14 18:40:13	Initialised AES-256 SDCTR client->server encryption
2019-08-14 18:40:13	Initialised HMAC-SHA-256 client->server MAC algorithm
2019-08-14 18:40:13	Initialised AES-256 SDCTR server->client encryption
2019-08-14 18:40:13	Initialised HMAC-SHA-256 server->client MAC algorithm
2019-08-14 19:40:13	Initiating key re-exchange (timeout)
2019-08-14 19:40:13	Doing Diffie-Hellman group exchange
2019-08-14 19:40:13	Doing Diffie-Hellman key exchange with hash SHA-256
2019-08-14 19:40:13	Initialised AES-256 SDCTR client->server encryption
2019-08-14 19:40:13	Initialised HMAC-SHA-256 client->server MAC algorithm
2019-08-14 19:40:13	Initialised AES-256 SDCTR server->client encryption
2019-08-14 19:40:13	Initialised HMAC-SHA-256 server->client MAC algorithm
2019-08-14 20:00:35	Network error: Software caused connection abort
*/

-- characterize purchase type, dine-in/takeout/drive-thru, by quarter/year
select DW_OCCASION, count(*) from TLD_FACT_2014_Q03 group by DW_OCCASION;

-- characterize purchase time, late night/breakfast/lunch/afternoon/dinner/evening
select t.DW_DAYPART, count(*) from TLD_FACT_2015_Q01 left join TIME_MINUTE_DIM t using(DW_MINUTE) group by DW_DAYPART;
select t.DW_DAYPART, count(*) from TLD_FACT_2015_Q02 left join TIME_MINUTE_DIM t using(DW_MINUTE) group by DW_DAYPART;
select t.DW_DAYPART, count(*) from TLD_FACT_2015_Q03 left join TIME_MINUTE_DIM t using(DW_MINUTE) group by DW_DAYPART;
select t.DW_DAYPART, count(*) from TLD_FACT_2015_Q04 left join TIME_MINUTE_DIM t using(DW_MINUTE) group by DW_DAYPART;






select t.DW_PRODUCT, g.PRODUCTGROUPDESC, p.PRODUCTDESC, t.DW_GC_HEADER
FROM TLD_FACT_2007_Q02 t
left join PRODUCT_DIM p using(DW_PRODUCT)
left join PRODUCT_GROUP_DET g using(DW_PRODUCTGROUP)
where DW_PRODUCT=1769
limit 20;
/*
+------------+------------------+-------------+--------------+
| DW_PRODUCT | PRODUCTGROUPDESC | PRODUCTDESC | DW_GC_HEADER |
+------------+------------------+-------------+--------------+
|       1769 | COMBOS           | COMBO 8     |   2268477514 |
|       1769 | COMBOS           | COMBO 8     |   2268477514 |
|       1769 | COMBOS           | COMBO 8     |   2268477514 |
|       1769 | COMBOS           | COMBO 8     |   2268484138 |
|       1769 | COMBOS           | COMBO 8     |   2268484138 |
|       1769 | COMBOS           | COMBO 8     |   2268484138 |
|       1769 | COMBOS           | COMBO 8     |   2268486944 |
|       1769 | COMBOS           | COMBO 8     |   2268486944 |
|       1769 | COMBOS           | COMBO 8     |   2268486944 |
|       1769 | COMBOS           | COMBO 8     |   2268486944 |
|       1769 | COMBOS           | COMBO 8     |   2268893456 |
|       1769 | COMBOS           | COMBO 8     |   2268894238 |
|       1769 | COMBOS           | COMBO 8     |   2268893456 |
|       1769 | COMBOS           | COMBO 8     |   2268894238 |
|       1769 | COMBOS           | COMBO 8     |   2268893456 |
|       1769 | COMBOS           | COMBO 8     |   2268894238 |
|       1769 | COMBOS           | COMBO 8     |   2268893456 |
|       1769 | COMBOS           | COMBO 8     |   2268894238 |
|       1769 | COMBOS           | COMBO 8     |   2268396382 |
|       1769 | COMBOS           | COMBO 8     |   2268396382 |
+------------+------------------+-------------+--------------+
*/

/*
+--------------+--------+-----------+-----------+-------------+---------------+----------------+----------------------+------------+------------------+---------------+-------------+-------------+--------------+---------+------------+-------------+-----------+------------+--------------+---------------+-------------+---------------+--------------+--------+------------+---------------------------------+
| DW_GC_HEADER | DW_DAY | DW_MINUTE | DW_RESTID | DW_OCCASION | DW_TENDERTYPE | DW_LINEITEMSEQ | DW_LINEITEMSEQPARENT | DW_PRODUCT | DW_PRODUCTDETAIL | DW_PRODUCTMOD | DW_DISCOUNT | DW_LINEITEM | SEASONFACTOR | COUNTER | ACTQTYSOLD | ACTPROMOQTY | ACTMODQTY | ACTDISCQTY | ACTPRODPRICE | ACTGROSSSALES | ACTNETSALES | ACTPROMOSALES | ACTDISCSALES | ACTTAX | DW_CHANNEL | DW_CHECK_IN_LOCATION_IDENTIFIER |
+--------------+--------+-----------+-----------+-------------+---------------+----------------+----------------------+------------+------------------+---------------+-------------+-------------+--------------+---------+------------+-------------+-----------+------------+--------------+---------------+-------------+---------------+--------------+--------+------------+---------------------------------+
|   2268477514 |   6294 |       723 |     31704 |           2 |             1 |              8 |                    8 |         -1 |               -1 |            -1 |          -1 |          14 |       1.0000 |       1 |       0.00 |           0 |       0.0 |          0 |         0.00 |          0.00 |        0.00 |          0.00 |         0.00 |   0.46 |          1 |                              -1 |
|   2268477514 |   6294 |       723 |     31704 |           2 |             1 |              6 |                    4 |        802 |              802 |          2549 |          -1 |          10 |       1.0000 |       1 |       0.00 |           0 |       1.0 |          0 |         0.00 |          0.00 |        0.00 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   2268477514 |   6294 |       723 |     31704 |           2 |             1 |              5 |                    4 |        802 |              802 |          3903 |          -1 |          11 |       1.0000 |       1 |       0.00 |           0 |       1.0 |          0 |         0.00 |          0.00 |        0.00 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   2268477514 |   6294 |       723 |     31704 |           2 |             1 |              4 |                    4 |        802 |              802 |            -1 |          -1 |           2 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         0.89 |          0.89 |        0.89 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   2268477514 |   6294 |       723 |     31704 |           2 |             1 |              2 |                    1 |       1769 |             3649 |            -1 |          -1 |           3 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         0.00 |          0.00 |        0.00 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   2268477514 |   6294 |       723 |     31704 |           2 |             1 |              3 |                    1 |       1769 |             4450 |            -1 |          -1 |           3 |       1.0000 |       1 |       3.00 |           0 |       0.0 |          0 |         0.00 |          0.00 |        0.00 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   2268477514 |   6294 |       723 |     31704 |           2 |             1 |              1 |                    1 |       1769 |             1769 |            -1 |          -1 |           1 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         3.49 |          3.49 |        3.49 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   2268477514 |   6294 |       723 |     31704 |           2 |             1 |              7 |                    7 |       3213 |             3213 |            -1 |          -1 |           2 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         1.19 |          1.19 |        1.19 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
+--------------+--------+-----------+-----------+-------------+---------------+----------------+----------------------+------------+------------------+---------------+-------------+-------------+--------------+---------+------------+-------------+-----------+------------+--------------+---------------+-------------+---------------+--------------+--------+------------+---------------------------------+
*/

/*
+------------+--------------+--------+-----------+-----------+-------------+---------------+----------------+----------------------+------------------+---------------+-------------+-------------+--------------+---------+------------+-------------+-----------+------------+--------------+---------------+-------------+---------------+--------------+--------+------------+---------------------------------+-----------------+-----------+----------------------+-----------------+---------------------+---------------------+----------------+
| DW_PRODUCT | DW_GC_HEADER | DW_DAY | DW_MINUTE | DW_RESTID | DW_OCCASION | DW_TENDERTYPE | DW_LINEITEMSEQ | DW_LINEITEMSEQPARENT | DW_PRODUCTDETAIL | DW_PRODUCTMOD | DW_DISCOUNT | DW_LINEITEM | SEASONFACTOR | COUNTER | ACTQTYSOLD | ACTPROMOQTY | ACTMODQTY | ACTDISCQTY | ACTPRODPRICE | ACTGROSSSALES | ACTNETSALES | ACTPROMOSALES | ACTDISCSALES | ACTTAX | DW_CHANNEL | DW_CHECK_IN_LOCATION_IDENTIFIER | DW_PRODUCTGROUP | PRODUCTCD | PRODUCTDESC          | PRODUCTSTATUSCD | PRODUCTSTATUSDT     | LASTUPDTDT          | LASTUPDTUSERID |
+------------+--------------+--------+-----------+-----------+-------------+---------------+----------------+----------------------+------------------+---------------+-------------+-------------+--------------+---------+------------+-------------+-----------+------------+--------------+---------------+-------------+---------------+--------------+--------+------------+---------------------------------+-----------------+-----------+----------------------+-----------------+---------------------+---------------------+----------------+
|      36010 |   4930703266 |   8403 |       857 |     41472 |           2 |             1 |              2 |                    2 |            36010 |            -1 |          -1 |           1 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         1.99 |          1.99 |        1.99 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |              35 | LRG DNK   | FRANCHISE LOCAL MENU | D               | 2012-09-07 21:00:12 | 2012-09-07 08:33:20 | DWT014         |
|      36010 |   4930703266 |   8403 |       857 |     41472 |           2 |             1 |              1 |                    1 |             3649 |            -1 |          -1 |           3 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         0.00 |          0.00 |        0.00 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |              35 | LRG DNK   | FRANCHISE LOCAL MENU | D               | 2012-09-07 21:00:12 | 2012-09-07 08:33:20 | DWT014         |
|      36011 |   4930705428 |   8403 |      1133 |     41472 |           3 |             1 |              1 |                    1 |             3648 |            -1 |          -1 |           3 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         0.00 |          0.00 |        0.00 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |              35 | MED DNK   | FRANCHISE LOCAL MENU | D               | 2012-09-07 21:00:12 | 2012-09-07 08:33:20 | DWT014         |
|      36011 |   4930705428 |   8403 |      1133 |     41472 |           3 |             1 |              2 |                    1 |            36011 |            -1 |          -1 |           1 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         1.79 |          1.79 |        1.79 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |              35 | MED DNK   | FRANCHISE LOCAL MENU | D               | 2012-09-07 21:00:12 | 2012-09-07 08:33:20 | DWT014         |
|      30164 |   4926074236 |   8401 |      1131 |     32205 |           2 |             3 |              6 |                    6 |            30164 |            -1 |          -1 |           2 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         1.00 |          1.00 |        1.00 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |              35 | 3TWST     | FRANCHISE LOCAL MENU | D               | 2009-11-11 21:00:18 | 2009-11-11 08:50:38 | DWT014         |
|      30164 |   4926076904 |   8401 |      1107 |     32319 |           2 |             3 |              2 |                    2 |            30164 |            -1 |          -1 |           2 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         1.00 |          1.00 |        1.00 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |              35 | 3TWST     | FRANCHISE LOCAL MENU | D               | 2009-11-11 21:00:18 | 2009-11-11 08:50:38 | DWT014         |
|      30164 |   4926076720 |   8401 |      1079 |     32319 |           3 |             1 |              1 |                    1 |            30164 |            -1 |          -1 |           2 |       1.0000 |       1 |       2.00 |           0 |       0.0 |          0 |         1.00 |          2.00 |        2.00 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |              35 | 3TWST     | FRANCHISE LOCAL MENU | D               | 2009-11-11 21:00:18 | 2009-11-11 08:50:38 | DWT014         |
|       6177 |   4926070449 |   8401 |       803 |     31901 |           3 |             1 |              1 |                    1 |             2098 |            -1 |          -1 |           6 |       1.0000 |       1 |       2.00 |           0 |       0.0 |          0 |         0.00 |          0.00 |        0.00 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |              35 | GRANDE    | FRANCHISE LOCAL MENU | D               | 2003-09-17 12:30:14 | 2003-09-16 18:47:22 | DWT014         |
|       6177 |   4926070449 |   8401 |       803 |     31901 |           3 |             1 |              2 |                    1 |             2100 |            -1 |          -1 |           3 |       1.0000 |       1 |       6.00 |           0 |       0.0 |          0 |         0.00 |          0.00 |        0.00 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |              35 | GRANDE    | FRANCHISE LOCAL MENU | D               | 2003-09-17 12:30:14 | 2003-09-16 18:47:22 | DWT014         |
|       6177 |   4926070449 |   8401 |       803 |     31901 |           3 |             1 |              1 |                    1 |             2094 |            -1 |          -1 |           6 |       1.0000 |       1 |       2.00 |           0 |       0.0 |          0 |         0.00 |          0.00 |        0.00 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |              35 | GRANDE    | FRANCHISE LOCAL MENU | D               | 2003-09-17 12:30:14 | 2003-09-16 18:47:22 | DWT014         |
|       6177 |   4926070449 |   8401 |       803 |     31901 |           3 |             1 |              3 |                    1 |             6177 |            -1 |          -1 |           1 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |        10.49 |         10.49 |       10.49 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |              35 | GRANDE    | FRANCHISE LOCAL MENU | D               | 2003-09-17 12:30:14 | 2003-09-16 18:47:22 | DWT014         |
|      30164 |   4975518813 |   8424 |       917 |     33627 |           2 |             3 |              4 |                    4 |            30164 |            -1 |          -1 |           2 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         1.00 |          1.00 |        1.00 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |              35 | 3TWST     | FRANCHISE LOCAL MENU | D               | 2009-11-11 21:00:18 | 2009-11-11 08:50:38 | DWT014         |
|      30164 |   4975518399 |   8424 |      1114 |     33627 |           1 |             1 |              1 |                    1 |            30164 |            -1 |          -1 |           2 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         1.00 |          1.00 |        1.00 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |              35 | 3TWST     | FRANCHISE LOCAL MENU | D               | 2009-11-11 21:00:18 | 2009-11-11 08:50:38 | DWT014         |
|      36011 |   4926077494 |   8401 |       867 |     32715 |           3 |             1 |              4 |                    3 |            36011 |            -1 |          -1 |           1 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         1.79 |          1.79 |        1.79 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |              35 | MED DNK   | FRANCHISE LOCAL MENU | D               | 2012-09-07 21:00:12 | 2012-09-07 08:33:20 | DWT014         |
|      36011 |   4926076344 |   8401 |      1035 |     32715 |           2 |             3 |              6 |                    5 |            36011 |            -1 |          -1 |           1 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         1.79 |          1.79 |        1.79 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |              35 | MED DNK   | FRANCHISE LOCAL MENU | D               | 2012-09-07 21:00:12 | 2012-09-07 08:33:20 | DWT014         |
|      36011 |   4926077494 |   8401 |       867 |     32715 |           3 |             1 |              3 |                    3 |             3648 |            -1 |          -1 |           3 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         0.00 |          0.00 |        0.00 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |              35 | MED DNK   | FRANCHISE LOCAL MENU | D               | 2012-09-07 21:00:12 | 2012-09-07 08:33:20 | DWT014         |
|      36011 |   4926076344 |   8401 |      1035 |     32715 |           2 |             3 |              5 |                    5 |             3648 |            -1 |          -1 |           3 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         0.00 |          0.00 |        0.00 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |              35 | MED DNK   | FRANCHISE LOCAL MENU | D               | 2012-09-07 21:00:12 | 2012-09-07 08:33:20 | DWT014         |
|      36011 |   4926079886 |   8401 |       804 |     32715 |           3 |             1 |              2 |                    2 |             3648 |            -1 |          -1 |           3 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         0.00 |          0.00 |        0.00 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |              35 | MED DNK   | FRANCHISE LOCAL MENU | D               | 2012-09-07 21:00:12 | 2012-09-07 08:33:20 | DWT014         |
|      36011 |   4926079886 |   8401 |       804 |     32715 |           3 |             1 |              3 |                    2 |            36011 |            -1 |          -1 |           1 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         1.79 |          1.79 |        1.79 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |              35 | MED DNK   | FRANCHISE LOCAL MENU | D               | 2012-09-07 21:00:12 | 2012-09-07 08:33:20 | DWT014         |
|      36012 |   4926078736 |   8401 |       924 |     32715 |           1 |             1 |              2 |                    2 |             3647 |            -1 |          -1 |           3 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         0.00 |          0.00 |        0.00 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |              35 | SML DNK   | FRANCHISE LOCAL MENU | D               | 2012-09-07 21:00:12 | 2012-09-07 08:33:20 | DWT014         |
+------------+--------------+--------+-----------+-----------+-------------+---------------+----------------+----------------------+------------------+---------------+-------------+-------------+--------------+---------+------------+-------------+-----------+------------+--------------+---------------+-------------+---------------+--------------+--------+------------+---------------------------------+-----------------+-----------+----------------------+-----------------+---------------------+---------------------+----------------+
*/

SELECT t.DW_GC_HEADER, t.DW_PRODUCT, t.DW_PRODUCTDETAIL, p.PRODUCTDESC, t.DW_PRODUCTMOD, t. ACTQTYSOLD, t.ACTMODQTY, t.ACTDISCQTY, t.ACTPRODPRICE, t.ACTGROSSSALES, t.ACTNETSALES, t.ACTTAX
from TLD_FACT_2013_Q01 t
	left join PRODUCT_DIM p using(DW_PRODUCT) 
where DW_GC_HEADER=5047855937
order by DW_GC_HEADER, DW_PRODUCT;
/*
+--------------+------------+------------------+----------------------+---------------+------------+-----------+------------+--------------+---------------+-------------+--------+
| DW_GC_HEADER | DW_PRODUCT | DW_PRODUCTDETAIL | PRODUCTDESC          | DW_PRODUCTMOD | ACTQTYSOLD | ACTMODQTY | ACTDISCQTY | ACTPRODPRICE | ACTGROSSSALES | ACTNETSALES | ACTTAX |
+--------------+------------+------------------+----------------------+---------------+------------+-----------+------------+--------------+---------------+-------------+--------+
|   5047855937 |         -1 |               -1 | N/A                  |            -1 |       0.00 |       0.0 |          0 |         0.00 |          0.00 |        0.00 |   0.52 |
|   5047855937 |       1690 |             3365 | COMBO 5              |            -1 |       1.00 |       0.0 |          0 |         0.00 |          0.00 |        0.00 |   0.00 |
|   5047855937 |       1690 |             4005 | COMBO 5              |          4271 |       0.00 |       1.0 |          0 |         0.00 |          0.00 |        0.00 |   0.00 |
|   5047855937 |       1690 |             3649 | COMBO 5              |            -1 |       1.00 |       0.0 |          0 |         0.00 |          0.00 |        0.00 |   0.00 |
|   5047855937 |       1690 |             4005 | COMBO 5              |          2948 |       0.00 |       1.0 |          0 |         0.00 |          0.00 |        0.00 |   0.00 |
|   5047855937 |       1690 |             4005 | COMBO 5              |            -1 |       1.00 |       0.0 |          0 |         0.00 |          0.00 |        0.00 |   0.00 |
|   5047855937 |       1690 |             4005 | COMBO 5              |          4582 |       0.00 |       1.0 |          0 |         0.00 |          0.00 |        0.00 |   0.00 |
|   5047855937 |       1690 |             1690 | COMBO 5              |            -1 |       1.00 |       0.0 |          0 |         5.49 |          5.49 |        5.49 |   0.00 |
|   5047855937 |       5528 |             5528 | FRANCHISE LOCAL MENU |            -1 |       1.00 |       0.0 |          0 |         1.59 |          1.59 |        1.59 |   0.00 |
|   5047855937 |       5528 |             5528 | FRANCHISE LOCAL MENU |          2948 |       0.00 |       1.0 |          0 |         0.00 |          0.00 |        0.00 |   0.00 |
+--------------+------------+------------------+----------------------+---------------+------------+-----------+------------+--------------+---------------+-------------+--------+
*/


select DW_DAY, DW_YEAR, DW_MONTH, FISCALYEARNO, FISCALYEARBGNDT, FISCALYEARENDDT, YEARBGNDT, YEARENDDT, MONTHNAME, BUSIDAYDT from TIME_DAY_DIM limit 5;

select BUSIDAYDT, QTRNAME, QTRBGNDT, QTRENDDT, MONTHNAME, MONTHBGNDT, MONTHENDDT, FISCALQTRNAME, FISCALQTRBGNDT, FISCALQTRENDDT, FISCALPRDNAME from TIME_DAY_DIM limit 5;
+----------------------+-------------+------+-----+---------+-------+
| Field                | Type        | Null | Key | Default | Extra |
+----------------------+-------------+------+-----+---------+-------+
| DW_FISCALWEEKPART    | smallint(6) | NO   |     | NULL    |       |

| MONTHENDDAY          | varchar(9)  | NO   |     | NULL    |       |
| MONTHDAYCNT          | smallint(6) | NO   |     | NULL    |       |
| FISCALPRDNO          | varchar(13) | NO   |     | NULL    |       |
|         | varchar(9)  | NO   |     | NULL    |       |
| FISCALPRDBGNDT       | date        | NO   |     | NULL    |       |
| FISCALPRDBGNDAY      | varchar(9)  | NO   |     | NULL    |       |
| FISCALPRDENDDT       | date        | NO   |     | NULL    |       |
| FISCALPRDENDDAY      | varchar(9)  | NO   |     | NULL    |       |
| FISCALPRDDAYCNT      | smallint(6) | NO   |     | NULL    |       |
| FISCALWEEKNO         | varchar(17) | NO   |     | NULL    |       |
| FISCALPRDWEEKNAME    | varchar(6)  | NO   |     | NULL    |       |
| FISCALYRWEEKNAME     | varchar(7)  | NO   |     | NULL    |       |
| FISCALWKBGNDT        | date        | NO   |     | NULL    |       |
| FISCALWKBGNDAY       | varchar(9)  | NO   |     | NULL    |       |
| FISCALWKENDDT        | date        | NO   |     | NULL    |       |
| FISCALWKENDDAY       | varchar(9)  | NO   |     | NULL    |       |
| FISCALWKDAYCNT       | smallint(6) | NO   |     | NULL    |       |
| MKTWINDOWNAME        | varchar(30) | YES  |     | NULL    |       |
| MKTWINDOW            | varchar(8)  | YES  |     | NULL    |       |
| MKTWINDOWDESC        | varchar(30) | YES  |     | NULL    |       |
| FISCALWEEKPARTNAME   | varchar(15) | NO   |     | NULL    |       |
| FISCALWEEKPARTBGNDAY | varchar(9)  | NO   |     | NULL    |       |
| FISCALWEEKPARTENDDAY | varchar(9)  | NO   |     | NULL    |       |
| BUSIDAYNO            | varchar(21) | NO   |     | NULL    |       |
| BUSIDAYNAME          | varchar(9)  | NO   |     | NULL    |       |
|             | date        | NO   |     | NULL    |       |
| BUSIDAYCNT           | smallint(6) | NO   |     | NULL    |       |
| DAYOFPERIOD          | smallint(6) | NO   |     | NULL    |       |
| DAYOFWEEK            | smallint(6) | NO   |     | NULL    |       |
+----------------------+-------------+------+-----+---------+-------+





