/*
+--------------+--------+-----------+------------+-------------+------------+--------------+---------------+-------------+--------+-------------------------+-------------------------+
| DW_GC_HEADER | DW_DAY | DW_RESTID | DW_PRODUCT | DW_LINEITEM | ACTQTYSOLD | ACTPRODPRICE | ACTGROSSSALES | ACTNETSALES | ACTTAX | LINEITEMDESC            | PRODUCTDESC             |
+--------------+--------+-----------+------------+-------------+------------+--------------+---------------+-------------+--------+-------------------------+-------------------------+
|   2193837648 |   6210 |     31704 |         -1 |          14 |       0.00 |         0.00 |          0.00 |        0.00 |   0.86 | TAX-LINE                | N/A                     |
|   2193837648 |   6210 |     31704 |        884 |           2 |       1.00 |         2.99 |          2.99 |        2.99 |   0.00 | NON-COMBO-ITEM          | GRILL STUFT BURRITO STK |
|   2193837648 |   6210 |     31704 |       1691 |           4 |       1.00 |         0.00 |          0.00 |        0.00 |   0.00 | COMBO-DETAIL-REPLS-PLUS | COMBO 6                 |
|   2193837648 |   6210 |     31704 |       1691 |           3 |       1.00 |         0.00 |          0.00 |        0.00 |   0.00 | COMBO-DETAIL            | COMBO 6                 |
|   2193837648 |   6210 |     31704 |       1691 |           4 |       1.00 |         0.00 |          0.00 |        0.00 |   0.00 | COMBO-DETAIL-REPLS-PLUS | COMBO 6                 |
|   2193837648 |   6210 |     31704 |       1691 |           3 |       1.00 |         0.00 |          0.00 |        0.00 |   0.00 | COMBO-DETAIL            | COMBO 6                 |
|   2193837648 |   6210 |     31704 |       1691 |           1 |       1.00 |         5.69 |          5.69 |        5.69 |   0.00 | COMBO-ITEM              | COMBO 6                 |
|   2193837648 |   6210 |     31704 |       4035 |           2 |       1.00 |         1.69 |          1.69 |        1.69 |   0.00 | NON-COMBO-ITEM          | GRILLED STEAK TACO      |
|   2193837648 |   6210 |     31704 |         -1 |          14 |       0.00 |         0.00 |          0.00 |        0.00 |   0.86 | TAX-LINE                | N/A                     |
|   2193837648 |   6210 |     31704 |        884 |           2 |       1.00 |         2.99 |          2.99 |        2.99 |   0.00 | NON-COMBO-ITEM          | GRILL STUFT BURRITO STK |
|   2193837648 |   6210 |     31704 |       1691 |           4 |       1.00 |         0.00 |          0.00 |        0.00 |   0.00 | COMBO-DETAIL-REPLS-PLUS | COMBO 6                 |
|   2193837648 |   6210 |     31704 |       1691 |           3 |       1.00 |         0.00 |          0.00 |        0.00 |   0.00 | COMBO-DETAIL            | COMBO 6                 |
|   2193837648 |   6210 |     31704 |       1691 |           4 |       1.00 |         0.00 |          0.00 |        0.00 |   0.00 | COMBO-DETAIL-REPLS-PLUS | COMBO 6                 |
|   2193837648 |   6210 |     31704 |       1691 |           3 |       1.00 |         0.00 |          0.00 |        0.00 |   0.00 | COMBO-DETAIL            | COMBO 6                 |
|   2193837648 |   6210 |     31704 |       1691 |           1 |       1.00 |         5.69 |          5.69 |        5.69 |   0.00 | COMBO-ITEM              | COMBO 6                 |
|   2193837648 |   6210 |     31704 |       4035 |           2 |       1.00 |         1.69 |          1.69 |        1.69 |   0.00 | NON-COMBO-ITEM          | GRILLED STEAK TACO      |
+--------------+--------+-----------+------------+-------------+------------+--------------+---------------+-------------+--------+-------------------------+-------------------------+
*/

-- select sample transactions
select t.DW_GC_HEADER, t.DW_DAY, t.DW_RESTID, t.DW_PRODUCT, p.PRODUCTDESC, t.DW_LINEITEM, l.LINEITEMDESC, t.ACTQTYSOLD, t.ACTPRODPRICE, t.ACTGROSSSALES, t.ACTTAX, a.OPENEDDT, a.CLOSEDDT
from TLD_FACT t
    left join LINEITEM_DIM l using (DW_LINEITEM)
    left join PRODUCT_DIM p using (DW_PRODUCT)
    left join ALIGN_DIM a using (DW_RESTID)
where DW_GC_HEADER=2193837648
    or DW_GC_HEADER=2193837602
    or DW_GC_HEADER=2193837510
    or DW_GC_HEADER=2193838982
order by DW_GC_HEADER; --16 min 4.40 sec
/*
+--------------+--------+-----------+------------+-------------------------+-------------+-------------------------+------------+--------------+---------------+--------+------------+------------+
| DW_GC_HEADER | DW_DAY | DW_RESTID | DW_PRODUCT | PRODUCTDESC             | DW_LINEITEM | LINEITEMDESC            | ACTQTYSOLD | ACTPRODPRICE | ACTGROSSSALES | ACTTAX | OPENEDDT   | CLOSEDDT   |
+--------------+--------+-----------+------------+-------------------------+-------------+-------------------------+------------+--------------+---------------+--------+------------+------------+
|   2193837510 |   6210 |     31704 |         -1 | N/A                     |          14 | TAX-LINE                |       0.00 |         0.00 |          0.00 |   0.43 | 2001-06-13 | 2007-12-23 |
|   2193837510 |   6210 |     31704 |       4001 | SOFT TACO BEEF          |           2 | NON-COMBO-ITEM          |       2.00 |         0.79 |          1.58 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837510 |   6210 |     31704 |      19494 | TB CRUNCHWRAP SUP CMB   |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837510 |   6210 |     31704 |      19494 | TB CRUNCHWRAP SUP CMB   |           8 | COMBO-MOD-INGRD-MINUS   |       0.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837510 |   6210 |     31704 |      19494 | TB CRUNCHWRAP SUP CMB   |           8 | COMBO-MOD-INGRD-MINUS   |       0.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837510 |   6210 |     31704 |      19494 | TB CRUNCHWRAP SUP CMB   |           1 | COMBO-ITEM              |       1.00 |         3.69 |          3.69 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837510 |   6210 |     31704 |      19494 | TB CRUNCHWRAP SUP CMB   |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837510 |   6210 |     31704 |      19494 | TB CRUNCHWRAP SUP CMB   |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837510 |   6210 |     31704 |      19494 | TB CRUNCHWRAP SUP CMB   |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837510 |   6210 |     31704 |         -1 | N/A                     |          14 | TAX-LINE                |       0.00 |         0.00 |          0.00 |   0.43 | 2001-06-13 | 2007-12-23 |
|   2193837510 |   6210 |     31704 |      19494 | TB CRUNCHWRAP SUP CMB   |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837510 |   6210 |     31704 |      19494 | TB CRUNCHWRAP SUP CMB   |           1 | COMBO-ITEM              |       1.00 |         3.69 |          3.69 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837510 |   6210 |     31704 |      19494 | TB CRUNCHWRAP SUP CMB   |           8 | COMBO-MOD-INGRD-MINUS   |       0.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837510 |   6210 |     31704 |      19494 | TB CRUNCHWRAP SUP CMB   |           8 | COMBO-MOD-INGRD-MINUS   |       0.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837510 |   6210 |     31704 |      19494 | TB CRUNCHWRAP SUP CMB   |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837510 |   6210 |     31704 |       4001 | SOFT TACO BEEF          |          11 | NON-COMBO-M-INGRD-MINUS |       0.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837510 |   6210 |     31704 |       4001 | SOFT TACO BEEF          |           2 | NON-COMBO-ITEM          |       2.00 |         0.79 |          1.58 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837510 |   6210 |     31704 |       4001 | SOFT TACO BEEF          |          11 | NON-COMBO-M-INGRD-MINUS |       0.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837602 |   6210 |     31704 |         -1 | N/A                     |          14 | TAX-LINE                |       0.00 |         0.00 |          0.00 |   0.79 | 2001-06-13 | 2007-12-23 |
|   2193837602 |   6210 |     31704 |       1689 | COMBO 4                 |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837602 |   6210 |     31704 |       1689 | COMBO 4                 |           3 | COMBO-DETAIL            |       2.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837602 |   6210 |     31704 |       1689 | COMBO 4                 |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837602 |   6210 |     31704 |       1689 | COMBO 4                 |           1 | COMBO-ITEM              |       1.00 |         4.99 |          4.99 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837602 |   6210 |     31704 |       1690 | COMBO 5                 |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837602 |   6210 |     31704 |       1690 | COMBO 5                 |           1 | COMBO-ITEM              |       1.00 |         4.59 |          4.59 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837602 |   6210 |     31704 |       1690 | COMBO 5                 |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837602 |   6210 |     31704 |       1690 | COMBO 5                 |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837602 |   6210 |     31704 |       1690 | COMBO 5                 |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837602 |   6210 |     31704 |       1690 | COMBO 5                 |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837602 |   6210 |     31704 |       1690 | COMBO 5                 |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837602 |   6210 |     31704 |       1690 | COMBO 5                 |           1 | COMBO-ITEM              |       1.00 |         4.59 |          4.59 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837602 |   6210 |     31704 |       1689 | COMBO 4                 |           1 | COMBO-ITEM              |       1.00 |         4.99 |          4.99 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837602 |   6210 |     31704 |       1689 | COMBO 4                 |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837602 |   6210 |     31704 |       1689 | COMBO 4                 |           3 | COMBO-DETAIL            |       2.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837602 |   6210 |     31704 |       1689 | COMBO 4                 |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837602 |   6210 |     31704 |         -1 | N/A                     |          14 | TAX-LINE                |       0.00 |         0.00 |          0.00 |   0.79 | 2001-06-13 | 2007-12-23 |
|   2193837648 |   6210 |     31704 |       4035 | GRILLED STEAK TACO      |           2 | NON-COMBO-ITEM          |       1.00 |         1.69 |          1.69 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837648 |   6210 |     31704 |       1691 | COMBO 6                 |           4 | COMBO-DETAIL-REPLS-PLUS |       1.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837648 |   6210 |     31704 |       1691 | COMBO 6                 |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837648 |   6210 |     31704 |         -1 | N/A                     |          14 | TAX-LINE                |       0.00 |         0.00 |          0.00 |   0.86 | 2001-06-13 | 2007-12-23 |
|   2193837648 |   6210 |     31704 |       1691 | COMBO 6                 |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837648 |   6210 |     31704 |        884 | GRILL STUFT BURRITO STK |           2 | NON-COMBO-ITEM          |       1.00 |         2.99 |          2.99 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837648 |   6210 |     31704 |       1691 | COMBO 6                 |           4 | COMBO-DETAIL-REPLS-PLUS |       1.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837648 |   6210 |     31704 |       1691 | COMBO 6                 |           4 | COMBO-DETAIL-REPLS-PLUS |       1.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837648 |   6210 |     31704 |         -1 | N/A                     |          14 | TAX-LINE                |       0.00 |         0.00 |          0.00 |   0.86 | 2001-06-13 | 2007-12-23 |
|   2193837648 |   6210 |     31704 |       1691 | COMBO 6                 |           1 | COMBO-ITEM              |       1.00 |         5.69 |          5.69 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837648 |   6210 |     31704 |        884 | GRILL STUFT BURRITO STK |           2 | NON-COMBO-ITEM          |       1.00 |         2.99 |          2.99 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837648 |   6210 |     31704 |       4035 | GRILLED STEAK TACO      |           2 | NON-COMBO-ITEM          |       1.00 |         1.69 |          1.69 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837648 |   6210 |     31704 |       1691 | COMBO 6                 |           1 | COMBO-ITEM              |       1.00 |         5.69 |          5.69 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837648 |   6210 |     31704 |       1691 | COMBO 6                 |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837648 |   6210 |     31704 |       1691 | COMBO 6                 |           4 | COMBO-DETAIL-REPLS-PLUS |       1.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193837648 |   6210 |     31704 |       1691 | COMBO 6                 |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 2001-06-13 | 2007-12-23 |
|   2193838982 |   6210 |     31751 |       1680 | COMBO 1                 |           1 | COMBO-ITEM              |       1.00 |         4.19 |          4.19 |   0.00 | 1995-04-21 | 2012-10-02 |
|   2193838982 |   6210 |     31751 |       1680 | COMBO 1                 |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 1995-04-21 | 2012-10-02 |
|   2193838982 |   6210 |     31751 |       1680 | COMBO 1                 |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 1995-04-21 | 2012-10-02 |
|   2193838982 |   6210 |     31751 |       1680 | COMBO 1                 |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 1995-04-21 | 2012-10-02 |
|   2193838982 |   6210 |     31751 |       1680 | COMBO 1                 |           8 | COMBO-MOD-INGRD-MINUS   |       0.00 |         0.00 |          0.00 |   0.00 | 1995-04-21 | 2012-10-02 |
|   2193838982 |   6210 |     31751 |         -1 | N/A                     |          14 | TAX-LINE                |       0.00 |         0.00 |          0.00 |   0.35 | 1995-04-21 | 2012-10-02 |
|   2193838982 |   6210 |     31751 |       1680 | COMBO 1                 |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 1995-04-21 | 2012-10-02 |
|   2193838982 |   6210 |     31751 |         -1 | N/A                     |          14 | TAX-LINE                |       0.00 |         0.00 |          0.00 |   0.35 | 1995-04-21 | 2012-10-02 |
|   2193838982 |   6210 |     31751 |       1680 | COMBO 1                 |           8 | COMBO-MOD-INGRD-MINUS   |       0.00 |         0.00 |          0.00 |   0.00 | 1995-04-21 | 2012-10-02 |
|   2193838982 |   6210 |     31751 |       3233 | MILD SAUCE              |           2 | NON-COMBO-ITEM          |       1.00 |         0.00 |          0.00 |   0.00 | 1995-04-21 | 2012-10-02 |
|   2193838982 |   6210 |     31751 |       1680 | COMBO 1                 |           1 | COMBO-ITEM              |       1.00 |         4.19 |          4.19 |   0.00 | 1995-04-21 | 2012-10-02 |
|   2193838982 |   6210 |     31751 |       1680 | COMBO 1                 |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 1995-04-21 | 2012-10-02 |
|   2193838982 |   6210 |     31751 |       1680 | COMBO 1                 |           3 | COMBO-DETAIL            |       1.00 |         0.00 |          0.00 |   0.00 | 1995-04-21 | 2012-10-02 |
|   2193838982 |   6210 |     31751 |       3233 | MILD SAUCE              |           2 | NON-COMBO-ITEM          |       1.00 |         0.00 |          0.00 |   0.00 | 1995-04-21 | 2012-10-02 |
+--------------+--------+-----------+------------+-------------------------+-------------+-------------------------+------------+--------------+---------------+--------+------------+------------+
*/

-- connect product_dim and product_group_det
select p.DW_PRODUCT, p.PRODUCTDESC, p.DW_PRODUCTGROUP, d.PRODUCTGROUPDESC
from PRODUCT_DIM p
	left join PRODUCT_GROUP_DET d using(DW_PRODUCTGROUP)
where PRODUCTDESC="COMBO 4";
/*
+------------+-------------+-----------------+------------------+
| DW_PRODUCT | PRODUCTDESC | DW_PRODUCTGROUP | PRODUCTGROUPDESC |
+------------+-------------+-----------------+------------------+
|       1673 | COMBO 4     |              29 | COMBOS           |
|       2271 | COMBO 4     |              29 | COMBOS           |
|       1738 | COMBO 4     |              29 | COMBOS           |
|       1642 | COMBO 4     |              29 | COMBOS           |
|       1689 | COMBO 4     |              29 | COMBOS           |
|      36572 | COMBO 4     |              29 | COMBOS           |
|       3129 | COMBO 4     |              29 | COMBOS           |
|       4512 | COMBO 4     |              29 | COMBOS           |
+------------+-------------+-----------------+------------------+
*/

-- columns in question
-- DW_CHANNEL, DW_GC_HEADER
describe LINEITEM_SEQ_DIM;
/*
+----------------+-------------+------+-----+---------+-------+
| Field          | Type        | Null | Key | Default | Extra |
+----------------+-------------+------+-----+---------+-------+
| DW_LINEITEMSEQ | smallint(6) | NO   | PRI | NULL    |       |
| LINEITEMSEQ    | smallint(6) | NO   |     | NULL    |       |
+----------------+-------------+------+-----+---------+-------+
*/

select * from LINEITEM_SEQ_DIM; --nothing useful

-- use TLD_FACT_2015_Q01 as an example
select t.DW_GC_HEADER, t.DW_DAY, t.DW_RESTID, t.DW_PRODUCT, t.DW_LINEITEM, t.ACTQTYSOLD, t.ACTPRODPRICE, t.ACTGROSSSALES, t.ACTTAX, a.OPENEDDT, a.CLOSEDDT
from TLD_FACT_2015_Q01 t
    left join ALIGN_DIM a using (DW_RESTID)
where OPENEDDT!="0000-00-00"
	and CLOSEDDT="0000-00-00"
limit 20;
/*
+--------------+--------+-----------+------------+-------------+------------+--------------+---------------+--------+------------+------------+
| DW_GC_HEADER | DW_DAY | DW_RESTID | DW_PRODUCT | DW_LINEITEM | ACTQTYSOLD | ACTPRODPRICE | ACTGROSSSALES | ACTTAX | OPENEDDT   | CLOSEDDT   |
+--------------+--------+-----------+------------+-------------+------------+--------------+---------------+--------+------------+------------+
|   7008434308 |   9196 |    150215 |      37591 |           4 |       1.00 |         0.00 |          0.00 |   0.00 | 2006-03-15 | 0000-00-00 |
|   7008434308 |   9196 |    150215 |       1692 |           3 |       1.00 |         0.00 |          0.00 |   0.00 | 2006-03-15 | 0000-00-00 |
|   7008434308 |   9196 |    150215 |      37667 |           2 |       3.00 |         1.69 |          5.07 |   0.00 | 2006-03-15 | 0000-00-00 |
|   7008434492 |   9196 |    150216 |        802 |           2 |       1.00 |         1.19 |          1.19 |   0.00 | 2006-03-15 | 0000-00-00 |
|   7008434492 |   9196 |    150216 |      36021 |           1 |       1.00 |         4.29 |          4.29 |   0.00 | 2006-03-15 | 0000-00-00 |
|   7008434492 |   9196 |    150216 |      36021 |           3 |       1.00 |         0.00 |          0.00 |   0.00 | 2006-03-15 | 0000-00-00 |
|   7008434492 |   9196 |    150216 |      36935 |           2 |       1.00 |         3.39 |          3.39 |   0.00 | 2006-03-15 | 0000-00-00 |
|   7008434216 |   9196 |    150215 |       1689 |           3 |       1.00 |         0.00 |          0.00 |   0.00 | 2006-03-15 | 0000-00-00 |
|   7008434216 |   9196 |    150215 |      36021 |           3 |       1.00 |         0.00 |          0.00 |   0.00 | 2006-03-15 | 0000-00-00 |
|   7008434262 |   9196 |    150215 |       3354 |          11 |       0.00 |         0.00 |          0.00 |   0.00 | 2006-03-15 | 0000-00-00 |
|   7008434262 |   9196 |    150215 |       3354 |          11 |       0.00 |         0.00 |          0.00 |   0.00 | 2006-03-15 | 0000-00-00 |
|   7008434308 |   9196 |    150215 |      37591 |           1 |       1.00 |         7.18 |          7.18 |   0.00 | 2006-03-15 | 0000-00-00 |
|   7008434308 |   9196 |    150215 |       1692 |           1 |       1.00 |         5.69 |          5.69 |   0.00 | 2006-03-15 | 0000-00-00 |
|   7008434308 |   9196 |    150215 |      37202 |           2 |       3.00 |         1.69 |          5.07 |   0.00 | 2006-03-15 | 0000-00-00 |
+--------------+--------+-----------+------------+-------------+------------+--------------+---------------+--------+------------+------------+
*/

select * from TLD_FACT_2015_Q01 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492 order by DW_GC_HEADER; --runtime: 
/*
+--------------+--------+-----------+-----------+-------------+---------------+----------------+----------------------+------------+------------------+---------------+-------------+-------------+--------------+---------+------------+-------------+-----------+------------+--------------+---------------+-------------+---------------+--------------+--------+------------+---------------------------------+
| DW_GC_HEADER | DW_DAY | DW_MINUTE | DW_RESTID | DW_OCCASION | DW_TENDERTYPE | DW_LINEITEMSEQ | DW_LINEITEMSEQPARENT | DW_PRODUCT | DW_PRODUCTDETAIL | DW_PRODUCTMOD | DW_DISCOUNT | DW_LINEITEM | SEASONFACTOR | COUNTER | ACTQTYSOLD | ACTPROMOQTY | ACTMODQTY | ACTDISCQTY | ACTPRODPRICE | ACTGROSSSALES | ACTNETSALES | ACTPROMOSALES | ACTDISCSALES | ACTTAX | DW_CHANNEL | DW_CHECK_IN_LOCATION_IDENTIFIER |
+--------------+--------+-----------+-----------+-------------+---------------+----------------+----------------------+------------+------------------+---------------+-------------+-------------+--------------+---------+------------+-------------+-----------+------------+--------------+---------------+-------------+---------------+--------------+--------+------------+---------------------------------+
|   7008434308 |   9196 |      1377 |    150215 |           2 |             1 |             10 |                    8 |      37591 |            38194 |            -1 |          -1 |           4 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         0.00 |          0.00 |        0.00 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   7008434308 |   9196 |      1377 |    150215 |           2 |             1 |             12 |                    8 |      37591 |             4001 |            -1 |          -1 |           6 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         0.00 |          0.00 |        0.00 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   7008434308 |   9196 |      1377 |    150215 |           2 |             1 |              5 |                    4 |       1692 |             4001 |          2948 |          -1 |           8 |       1.0000 |       1 |       0.00 |           0 |       1.0 |          0 |         0.00 |          0.00 |        0.00 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   7008434308 |   9196 |      1377 |    150215 |           2 |             1 |             15 |                    8 |      37591 |            27270 |            -1 |          -1 |           3 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         0.00 |          0.00 |        0.00 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   7008434308 |   9196 |      1377 |    150215 |           2 |             1 |             13 |                    8 |      37591 |            34596 |            -1 |          -1 |           3 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         0.00 |          0.00 |        0.00 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   7008434308 |   9196 |      1377 |    150215 |           2 |             1 |              4 |                    1 |       1692 |             4001 |            -1 |          -1 |           6 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         0.00 |          0.00 |        0.00 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   7008434308 |   9196 |      1377 |    150215 |           2 |             1 |             16 |                   16 |      37202 |            37202 |            -1 |          -1 |           2 |       1.0000 |       1 |       3.00 |           0 |       0.0 |          0 |         1.69 |          5.07 |        5.07 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   7008434308 |   9196 |      1377 |    150215 |           2 |             1 |              1 |                    1 |       1692 |             1692 |            -1 |          -1 |           1 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         5.69 |          5.69 |        5.69 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   7008434308 |   9196 |      1377 |    150215 |           2 |             1 |              8 |                    8 |      37591 |            37591 |            -1 |          -1 |           1 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         7.18 |          7.18 |        7.18 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   7008434308 |   9196 |      1377 |    150215 |           2 |             1 |            999 |                  999 |         -1 |               -1 |            -1 |          -1 |          14 |       1.0000 |       1 |       0.00 |           0 |       0.0 |          0 |         0.00 |          0.00 |        0.00 |          0.00 |         0.00 |   1.61 |          1 |                              -1 |
|   7008434308 |   9196 |      1377 |    150215 |           2 |             1 |             17 |                   17 |      37667 |            37667 |            -1 |          -1 |           2 |       1.0000 |       1 |       3.00 |           0 |       0.0 |          0 |         1.69 |          5.07 |        5.07 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   7008434308 |   9196 |      1377 |    150215 |           2 |             1 |              7 |                    1 |       1692 |            27249 |            -1 |          -1 |           3 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         0.00 |          0.00 |        0.00 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   7008434308 |   9196 |      1377 |    150215 |           2 |             1 |              2 |                    1 |       1692 |             3844 |            -1 |          -1 |           3 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         0.00 |          0.00 |        0.00 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   7008434492 |   9196 |       816 |    150216 |           2 |             3 |              4 |                    1 |      36021 |            35519 |            -1 |          -1 |           3 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         0.00 |          0.00 |        0.00 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   7008434492 |   9196 |       816 |    150216 |           2 |             3 |              8 |                    5 |      36021 |             2171 |            -1 |          -1 |           3 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         0.00 |          0.00 |        0.00 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   7008434492 |   9196 |       816 |    150216 |           2 |             3 |              2 |                    1 |      36021 |            35930 |            -1 |          -1 |           3 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         0.00 |          0.00 |        0.00 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   7008434492 |   9196 |       816 |    150216 |           2 |             3 |              6 |                    5 |      36021 |            35930 |            -1 |          -1 |           3 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         0.00 |          0.00 |        0.00 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   7008434492 |   9196 |       816 |    150216 |           2 |             3 |              3 |                    1 |      36021 |            35518 |            -1 |          -1 |           3 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         0.00 |          0.00 |        0.00 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   7008434492 |   9196 |       816 |    150216 |           2 |             3 |              1 |                    1 |      36021 |            36021 |            -1 |          -1 |           1 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         4.29 |          4.29 |        4.29 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   7008434492 |   9196 |       816 |    150216 |           2 |             3 |              9 |                    9 |      36989 |            36989 |            -1 |          -1 |           2 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         1.79 |          1.79 |        1.79 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   7008434492 |   9196 |       816 |    150216 |           2 |             3 |             10 |                   10 |      36935 |            36935 |            -1 |          -1 |           2 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         3.39 |          3.39 |        3.39 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   7008434492 |   9196 |       816 |    150216 |           2 |             3 |              7 |                    5 |      36021 |             2144 |            -1 |          -1 |           3 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         0.00 |          0.00 |        0.00 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   7008434492 |   9196 |       816 |    150216 |           2 |             3 |              5 |                    5 |      36021 |            36021 |            -1 |          -1 |           1 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         4.29 |          4.29 |        4.29 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   7008434492 |   9196 |       816 |    150216 |           2 |             3 |             11 |                   11 |        802 |              802 |            -1 |          -1 |           2 |       1.0000 |       1 |       1.00 |           0 |       0.0 |          0 |         1.19 |          1.19 |        1.19 |          0.00 |         0.00 |   0.00 |          1 |                              -1 |
|   7008434492 |   9196 |       816 |    150216 |           2 |             3 |            999 |                  999 |         -1 |               -1 |            -1 |          -1 |          14 |       1.0000 |       1 |       0.00 |           0 |       0.0 |          0 |         0.00 |          0.00 |        0.00 |          0.00 |         0.00 |   1.05 |          1 |                              -1 |
+--------------+--------+-----------+-----------+-------------+---------------+----------------+----------------------+------------+------------------+---------------+-------------+-------------+--------------+---------+------------+-------------+-----------+------------+--------------+---------------+-------------+---------------+--------------+--------+------------+---------------------------------+
*/

-- compare records from quarterly table and master
select t.DW_GC_HEADER, t.DW_DAY, t.DW_RESTID, o.DW_OCCASION, o.OCCASIONDESC, t.DW_PRODUCT, p.PRODUCTDESC, t.DW_PRODUCTDETAIL, t.DW_PRODUCTMOD, t.DW_LINEITEM, l.LINEITEMDESC, t.DW_LINEITEMSEQ, t.DW_LINEITEMSEQPARENT, t.ACTQTYSOLD, t.ACTPRODPRICE, t.ACTGROSSSALES, t.ACTTAX
from TLD_FACT_2015_Q01 t
    left join LINEITEM_DIM l using (DW_LINEITEM)
    left join PRODUCT_DIM p using (DW_PRODUCT)
	left join OCCASION_DIM o using (DW_OCCASION)
where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492
order by DW_GC_HEADER, DW_PRODUCT;
/*

+--------------+--------+-----------+-------------+--------------+------------+--------------------------+------------------+---------------+-------------+-------------------------+----------------+----------------------+------------+--------------+---------------+--------+
| DW_GC_HEADER | DW_DAY | DW_RESTID | DW_OCCASION | OCCASIONDESC | DW_PRODUCT | PRODUCTDESC              | DW_PRODUCTDETAIL | DW_PRODUCTMOD | DW_LINEITEM | LINEITEMDESC            | DW_LINEITEMSEQ | DW_LINEITEMSEQPARENT | ACTQTYSOLD | ACTPRODPRICE | ACTGROSSSALES | ACTTAX |
+--------------+--------+-----------+-------------+--------------+------------+--------------------------+------------------+---------------+-------------+-------------------------+----------------+----------------------+------------+--------------+---------------+--------+
|   7008434308 |   9196 |    150215 |           2 | DRIVE-THRU   |         -1 | N/A                      |               -1 |            -1 |          14 | TAX-LINE                |            999 |                  999 |       0.00 |         0.00 |          0.00 |   1.61 |
|   7008434308 |   9196 |    150215 |           2 | DRIVE-THRU   |       1692 | COMBO 7                  |            27249 |            -1 |           3 | COMBO-DETAIL            |              7 |                    1 |       1.00 |         0.00 |          0.00 |   0.00 |
|   7008434308 |   9196 |    150215 |           2 | DRIVE-THRU   |       1692 | COMBO 7                  |             3844 |            -1 |           3 | COMBO-DETAIL            |              2 |                    1 |       1.00 |         0.00 |          0.00 |   0.00 |
|   7008434308 |   9196 |    150215 |           2 | DRIVE-THRU   |       1692 | COMBO 7                  |             4001 |            -1 |           6 | COMBO-DETAIL-REPLS-EQL  |              4 |                    1 |       1.00 |         0.00 |          0.00 |   0.00 |
|   7008434308 |   9196 |    150215 |           2 | DRIVE-THRU   |       1692 | COMBO 7                  |             4001 |          2948 |           8 | COMBO-MOD-INGRD-MINUS   |              5 |                    4 |       0.00 |         0.00 |          0.00 |   0.00 |
|   7008434308 |   9196 |    150215 |           2 | DRIVE-THRU   |       1692 | COMBO 7                  |             1692 |            -1 |           1 | COMBO-ITEM              |              1 |                    1 |       1.00 |         5.69 |          5.69 |   0.00 |
|   7008434308 |   9196 |    150215 |           2 | DRIVE-THRU   |      37202 | CRWRP SLDR CHD           |            37202 |            -1 |           2 | NON-COMBO-ITEM          |             16 |                   16 |       3.00 |         1.69 |          5.07 |   0.00 |
|   7008434308 |   9196 |    150215 |           2 | DRIVE-THRU   |      37591 | QUESARITO BOX            |            38194 |            -1 |           4 | COMBO-DETAIL-REPLS-PLUS |             10 |                    8 |       1.00 |         0.00 |          0.00 |   0.00 |
|   7008434308 |   9196 |    150215 |           2 | DRIVE-THRU   |      37591 | QUESARITO BOX            |            37591 |            -1 |           1 | COMBO-ITEM              |              8 |                    8 |       1.00 |         7.18 |          7.18 |   0.00 |
|   7008434308 |   9196 |    150215 |           2 | DRIVE-THRU   |      37591 | QUESARITO BOX            |            27270 |            -1 |           3 | COMBO-DETAIL            |             15 |                    8 |       1.00 |         0.00 |          0.00 |   0.00 |
|   7008434308 |   9196 |    150215 |           2 | DRIVE-THRU   |      37591 | QUESARITO BOX            |            34596 |            -1 |           3 | COMBO-DETAIL            |             13 |                    8 |       1.00 |         0.00 |          0.00 |   0.00 |
|   7008434308 |   9196 |    150215 |           2 | DRIVE-THRU   |      37591 | QUESARITO BOX            |             4001 |            -1 |           6 | COMBO-DETAIL-REPLS-EQL  |             12 |                    8 |       1.00 |         0.00 |          0.00 |   0.00 |
|   7008434308 |   9196 |    150215 |           2 | DRIVE-THRU   |      37667 | CW SLDR SPICY SC         |            37667 |            -1 |           2 | NON-COMBO-ITEM          |             17 |                   17 |       3.00 |         1.69 |          5.07 |   0.00 |
|   7008434492 |   9196 |    150216 |           2 | DRIVE-THRU   |         -1 | N/A                      |               -1 |            -1 |          14 | TAX-LINE                |            999 |                  999 |       0.00 |         0.00 |          0.00 |   1.05 |
|   7008434492 |   9196 |    150216 |           2 | DRIVE-THRU   |        802 | BEAN BURRITO             |              802 |            -1 |           2 | NON-COMBO-ITEM          |             11 |                   11 |       1.00 |         1.19 |          1.19 |   0.00 |
|   7008434492 |   9196 |    150216 |           2 | DRIVE-THRU   |      36021 | ROLLED CK 4-PK           |            35930 |            -1 |           3 | COMBO-DETAIL            |              6 |                    5 |       1.00 |         0.00 |          0.00 |   0.00 |
|   7008434492 |   9196 |    150216 |           2 | DRIVE-THRU   |      36021 | ROLLED CK 4-PK           |            35930 |            -1 |           3 | COMBO-DETAIL            |              2 |                    1 |       1.00 |         0.00 |          0.00 |   0.00 |
|   7008434492 |   9196 |    150216 |           2 | DRIVE-THRU   |      36021 | ROLLED CK 4-PK           |             2171 |            -1 |           3 | COMBO-DETAIL            |              8 |                    5 |       1.00 |         0.00 |          0.00 |   0.00 |
|   7008434492 |   9196 |    150216 |           2 | DRIVE-THRU   |      36021 | ROLLED CK 4-PK           |            35519 |            -1 |           3 | COMBO-DETAIL            |              4 |                    1 |       1.00 |         0.00 |          0.00 |   0.00 |
|   7008434492 |   9196 |    150216 |           2 | DRIVE-THRU   |      36021 | ROLLED CK 4-PK           |            36021 |            -1 |           1 | COMBO-ITEM              |              5 |                    5 |       1.00 |         4.29 |          4.29 |   0.00 |
|   7008434492 |   9196 |    150216 |           2 | DRIVE-THRU   |      36021 | ROLLED CK 4-PK           |             2144 |            -1 |           3 | COMBO-DETAIL            |              7 |                    5 |       1.00 |         0.00 |          0.00 |   0.00 |
|   7008434492 |   9196 |    150216 |           2 | DRIVE-THRU   |      36021 | ROLLED CK 4-PK           |            36021 |            -1 |           1 | COMBO-ITEM              |              1 |                    1 |       1.00 |         4.29 |          4.29 |   0.00 |
|   7008434492 |   9196 |    150216 |           2 | DRIVE-THRU   |      36021 | ROLLED CK 4-PK           |            35518 |            -1 |           3 | COMBO-DETAIL            |              3 |                    1 |       1.00 |         0.00 |          0.00 |   0.00 |
|   7008434492 |   9196 |    150216 |           2 | DRIVE-THRU   |      36935 | QUESARITO STEAK          |            36935 |            -1 |           2 | NON-COMBO-ITEM          |             10 |                   10 |       1.00 |         3.39 |          3.39 |   0.00 |
|   7008434492 |   9196 |    150216 |           2 | DRIVE-THRU   |      36989 | SHREDDED CHICKEN BURRITO |            36989 |            -1 |           2 | NON-COMBO-ITEM          |              9 |                    9 |       1.00 |         1.79 |          1.79 |   0.00 |
+--------------+--------+-----------+-------------+--------------+------------+--------------------------+------------------+---------------+-------------+-------------------------+----------------+----------------------+------------+--------------+---------------+--------+

*/

select t.DW_GC_HEADER, t.DW_DAY, t.DW_RESTID, o.DW_OCCASION, o.OCCASIONDESC, t.DW_PRODUCT, p.PRODUCTDESC, t.DW_PRODUCTDETAIL, t.DW_PRODUCTMOD, t.DW_LINEITEM, l.LINEITEMDESC, t.DW_LINEITEMSEQ, t.DW_LINEITEMSEQPARENT, t.ACTQTYSOLD, t.ACTPRODPRICE, t.ACTGROSSSALES, t.ACTTAX
from TLD_FACT t
    left join LINEITEM_DIM l using (DW_LINEITEM)
    left join PRODUCT_DIM p using (DW_PRODUCT)
	left join OCCASION_DIM o using (DW_OCCASION)
where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492
order by DW_GC_HEADER, DW_PRODUCT;
-- table empty

-- tab number of transactions in master and quarterly tables
select
	(select count(*) from TLD_FACT) as total,
	(select count(*) from TLD_FACT_2007_Q01) as 07q1,
	(select count(*) from TLD_FACT_2007_Q02) as 07q2,
	(select count(*) from TLD_FACT_2007_Q03) as 07q3,
	(select count(*) from TLD_FACT_2007_Q04) as 07q4,
	(select count(*) from TLD_FACT_2008_Q01) as 08q1,
	(select count(*) from TLD_FACT_2008_Q02) as 08q2,
	(select count(*) from TLD_FACT_2008_Q03) as 08q3,
	(select count(*) from TLD_FACT_2008_Q04) as 08q4,
	(select count(*) from TLD_FACT_2009_Q01) as 09q1,
	(select count(*) from TLD_FACT_2009_Q02) as 09q2,
	(select count(*) from TLD_FACT_2009_Q03) as 09q3,
	(select count(*) from TLD_FACT_2009_Q04) as 09q4,
	(select count(*) from TLD_FACT_2010_Q01) as 10q1,
	(select count(*) from TLD_FACT_2010_Q02) as 10q2,
	(select count(*) from TLD_FACT_2010_Q03) as 10q3,
	(select count(*) from TLD_FACT_2010_Q04) as 10q4,
	(select count(*) from TLD_FACT_2011_Q01) as 11q1,
	(select count(*) from TLD_FACT_2011_Q02) as 11q2,
	(select count(*) from TLD_FACT_2011_Q03) as 11q3,
	(select count(*) from TLD_FACT_2011_Q04) as 11q4,
	(select count(*) from TLD_FACT_2012_Q01) as 12q1,
	(select count(*) from TLD_FACT_2012_Q02) as 12q2,
	(select count(*) from TLD_FACT_2012_Q03) as 12q3,
	(select count(*) from TLD_FACT_2012_Q04) as 12q4,
	(select count(*) from TLD_FACT_2013_Q01) as 13q1,
	(select count(*) from TLD_FACT_2013_Q02) as 13q2,
	(select count(*) from TLD_FACT_2013_Q03) as 13q3,
	(select count(*) from TLD_FACT_2013_Q04) as 13q4,
	(select count(*) from TLD_FACT_2014_Q01) as 14q1,
	(select count(*) from TLD_FACT_2014_Q02) as 14q2,
	(select count(*) from TLD_FACT_2014_Q03) as 14q3,
	(select count(*) from TLD_FACT_2014_Q04) as 14q4,
	(select count(*) from TLD_FACT_2015_Q01) as 15q1,
	(select count(*) from TLD_FACT_2015_Q02) as 15q2,
	(select count(*) from TLD_FACT_2015_Q03) as 15q3;
/*
+------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+------------+------------+------------+------------+------------+-----------+------------+------------+------------+------------+------------+------------+
| total      | 07q1      | 07q2      | 07q3      | 07q4      | 08q1      | 08q2      | 08q3      | 08q4      | 09q1      | 09q2      | 09q3      | 09q4      | 10q1      | 10q2      | 10q3      | 10q4      | 11q1      | 11q2      | 11q3      | 11q4      | 12q1      | 12q2      | 12q3      | 12q4       | 13q1       | 13q2       | 13q3       | 13q4       | 14q1      | 14q2       | 14q3       | 14q4       | 15q1       | 15q2       | 15q3       |
+------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+------------+------------+------------+------------+------------+-----------+------------+------------+------------+------------+------------+------------+
| 4965182657 | 727957470 | 410591488 | 408919477 | 525394470 | 393761041 | 436986687 | 465021041 | 608088041 | 414278381 | 456293970 | 461288824 | 794410882 | 652860758 | 702903894 | 722179580 | 875304412 | 584204423 | 613618156 | 604264985 | 810326023 | 605991280 | 818032696 | 940370314 | 1239434138 | 1001924881 | 1152821407 | 1240517750 | 1556274400 | 806956251 | 1227420117 | 1240061145 | 1651024877 | 1207030560 | 1325307922 | 1353794936 |
+------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+------------+------------+------------+------------+------------+-----------+------------+------------+------------+------------+------------+------------+
*/	

select
	(select count(*) from TLD_FACT where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as total,
	(select count(*) from TLD_FACT_2007_Q01 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 07q1,
	(select count(*) from TLD_FACT_2007_Q02 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 07q2,
	(select count(*) from TLD_FACT_2007_Q03 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 07q3,
	(select count(*) from TLD_FACT_2007_Q04 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 07q4,
	(select count(*) from TLD_FACT_2008_Q01 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 08q1,
	(select count(*) from TLD_FACT_2008_Q02 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 08q2,
	(select count(*) from TLD_FACT_2008_Q03 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 08q3,
	(select count(*) from TLD_FACT_2008_Q04 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 08q4,
	(select count(*) from TLD_FACT_2009_Q01 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 09q1,
	(select count(*) from TLD_FACT_2009_Q02 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 09q2,
	(select count(*) from TLD_FACT_2009_Q03 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 09q3,
	(select count(*) from TLD_FACT_2009_Q04 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 09q4,
	(select count(*) from TLD_FACT_2010_Q01 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 10q1,
	(select count(*) from TLD_FACT_2010_Q02 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 10q2,
	(select count(*) from TLD_FACT_2010_Q03 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 10q3,
	(select count(*) from TLD_FACT_2010_Q04 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 10q4,
	(select count(*) from TLD_FACT_2011_Q01 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 11q1,
	(select count(*) from TLD_FACT_2011_Q02 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 11q2,
	(select count(*) from TLD_FACT_2011_Q03 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 11q3,
	(select count(*) from TLD_FACT_2011_Q04 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 11q4,
	(select count(*) from TLD_FACT_2012_Q01 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 12q1,
	(select count(*) from TLD_FACT_2012_Q02 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 12q2,
	(select count(*) from TLD_FACT_2012_Q03 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 12q3,
	(select count(*) from TLD_FACT_2012_Q04 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 12q4,
	(select count(*) from TLD_FACT_2013_Q01 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 13q1,
	(select count(*) from TLD_FACT_2013_Q02 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 13q2,
	(select count(*) from TLD_FACT_2013_Q03 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 13q3,
	(select count(*) from TLD_FACT_2013_Q04 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 13q4,
	(select count(*) from TLD_FACT_2014_Q01 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 14q1,
	(select count(*) from TLD_FACT_2014_Q02 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 14q2,
	(select count(*) from TLD_FACT_2014_Q03 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 14q3,
	(select count(*) from TLD_FACT_2014_Q04 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 14q4,
	(select count(*) from TLD_FACT_2015_Q01 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 15q1,
	(select count(*) from TLD_FACT_2015_Q02 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 15q2,
	(select count(*) from TLD_FACT_2015_Q03 where DW_GC_HEADER=7008434308 or DW_GC_HEADER=7008434492) as 15q3;

